import{_ as ae,u as ie,r as p,c as $,Y as q,o as re,b as n,e as N,d as e,t as u,q as f,f as T,B as I,M as U,g as z,O as L,w as m,v,T as de,s as k,Q as ue,z as x,N as pe,A as o,L as ce}from"./index-DsIss_bJ.js";import{A as E}from"./AccordionComponent-D14leHG-.js";const me={class:"space-y-6 p-4 bg-background"},ve={key:0,class:"flex justify-center items-center min-h-[200px]"},fe={key:1,class:"bg-red-900 text-white p-4 rounded-md border border-red-700 flex items-start"},xe={key:0,class:"w-5 h-5 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ge={key:1,class:"w-5 h-5 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},be={class:"flex justify-end space-x-4 mb-4"},ye=["disabled"],he={key:0,class:"flex items-center justify-center"},ke={key:1},we={class:"overflow-x-auto"},_e={class:"min-w-full divide-y divide-border"},Me={class:"bg-background-soft divide-y divide-border"},Ce={class:"px-4 py-3 text-text-light"},Ae={class:"px-4 py-3"},je={class:"flex space-x-2"},ze=["onClick"],Ge=["onClick"],Ve={class:"flex justify-end mb-4"},Be={key:0,class:"space-y-4"},$e={class:"overflow-x-auto"},Ne={class:"min-w-full divide-y divide-border"},Te={class:"bg-background-soft divide-y divide-border"},Ue={class:"px-4 py-3"},Le={class:"px-4 py-3 text-text-light"},Ee={class:"px-4 py-3"},Se=["href","title"],De={key:1,class:"text-text-light-muted"},Fe={class:"px-4 py-3"},Re={class:"flex flex-wrap gap-1"},He={class:"px-4 py-3 text-text-light"},Oe={class:"px-4 py-3"},qe={class:"flex space-x-2"},Ie=["onClick"],Ke=["onClick"],Je={key:1,class:"flex flex-col items-center justify-center py-12 text-text-light-muted"},Qe={key:3,class:"fixed inset-0 z-50 overflow-y-auto"},We={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ye={class:"inline-block align-bottom bg-background-soft rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Pe={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Xe={class:"text-lg font-medium leading-6 text-text-light mb-4"},Ze={class:"mb-4"},et={class:"bg-background-mute px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},tt=["disabled"],st={key:0,class:"flex items-center justify-center"},lt={key:1},ot={key:4,class:"fixed inset-0 z-50 overflow-y-auto"},nt={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},at={class:"inline-block align-bottom bg-background-soft rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},it={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},rt={class:"text-lg font-medium leading-6 text-text-light mb-4"},dt=["value"],ut={class:"flex flex-wrap gap-2 p-2 border border-border rounded"},pt={class:"text-text-light mr-2"},ct=["onClick"],mt=["onKeydown"],vt={class:"bg-background-mute px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ft=["disabled"],xt={key:0,class:"flex items-center justify-center"},gt={key:1},bt={__name:"JsonEditorComponent",setup(yt){const{success:S,error:K}=ie(),w=p(!1),G=p(""),d=p(""),c=p("success"),_=p(""),D=p({config:{},groups:{}}),M=$(()=>Object.entries(D.value.groups||{}).map(([l,t])=>({name:l,models:Array.isArray(t)?t:[]}))),g=p(!1),C=p(!1),J=$(()=>C.value?"Rename Group":"Add Group"),b=q({name:""});let F="";const y=p(!1),A=p(!1),Q=$(()=>A.value?"Edit Model":"Add Model"),i=q({group:"",url:"",dest:"",git:"",type:"",tags:[],hash:"",size:null}),V=p(!1),B=p(!1),W=l=>l.dest?l.dest.split("/").pop():l.git?l.git.split("/").pop():"Unnamed",Y=l=>Array.isArray(l.tags)&&l.tags.some(t=>t.toLowerCase()==="nsfw"),P=l=>l.tags?Array.isArray(l.tags)?l.tags:[l.tags]:[],X=()=>{_.value.trim()&&(i.tags.push(_.value.trim()),_.value="")},Z=l=>{i.tags.splice(l,1)};async function h(){var l,t;w.value=!0,G.value="";try{const s=(await x.get("/jsonmodels/")).data||{};D.value=s}catch(a){G.value=((t=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:t.detail)||a.message||"Loading error"}finally{w.value=!1}}function ee(){C.value=!1,b.name="",g.value=!0}function te(l){C.value=!0,b.name=l,F=l,g.value=!0}async function R(){var l,t;V.value=!0;try{C.value?(await x.put("/jsonmodels/groups",{old_group:F,new_group:b.name}),d.value="Group renamed"):(await x.post("/jsonmodels/groups",{group:b.name}),d.value="Group added"),c.value="success",g.value=!1,await h()}catch(a){d.value=((t=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:t.detail)||a.message,c.value="error"}finally{V.value=!1}}async function se(l){var t,a;if(confirm(`Delete group "${l}"?`))try{await x.delete("/jsonmodels/groups",{data:{group:l}}),d.value="Group deleted",c.value="success",await h()}catch(s){d.value=((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.detail)||s.message,c.value="error"}}function le(l=""){A.value=!1,Object.assign(i,{group:l,url:"",dest:"",git:"",type:"",tags:[],hash:"",size:null}),y.value=!0}function oe(l){A.value=!0,Object.assign(i,{group:H(l),url:l.url||"",dest:l.dest||"",git:l.git||"",type:l.type||"",tags:Array.isArray(l.tags)?[...l.tags]:l.tags?[l.tags]:[],hash:l.hash||"",size:l.size||null}),y.value=!0}function H(l){for(const t of M.value)if(t.models.some(a=>(a.dest||a.git)===(l.dest||l.git)))return t.name;return""}async function O(){var l,t;B.value=!0;try{const a={url:i.url,dest:i.dest,git:i.git,type:i.type,tags:i.tags,hash:i.hash,size:i.size};A.value?(await x.put("/jsonmodels/entry",{group:i.group,entry:a}),d.value="Model modified",S("Model updated successfully",5e3,!0)):(await x.post("/jsonmodels/entry",{group:i.group,entry:a}),d.value="Model added",S("Model added successfully",5e3,!0)),c.value="success",y.value=!1,await h()}catch(a){const s=((t=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:t.detail)||a.message;d.value=s,c.value="error",K(`Model operation failed: ${s}`,8e3,!0)}finally{B.value=!1}}async function ne(l){var t,a;if(confirm("Delete this model?"))try{await x.delete("/jsonmodels/entry",{data:{group:H(l),entry:{dest:l.dest,git:l.git}}}),d.value="Model deleted",c.value="success",await h()}catch(s){d.value=((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.detail)||s.message,c.value="error"}}return re(h),(l,t)=>{const a=pe("FontAwesomeIcon");return o(),n("div",me,[w.value?(o(),n("div",ve,t[15]||(t[15]=[e("div",{class:"flex flex-col items-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),e("p",{class:"mt-2 text-text-light"},"Loading models.json file...")],-1)]))):G.value?(o(),n("div",fe,[t[16]||(t[16]=e("svg",{class:"w-5 h-5 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,u(G.value),1)])):(o(),n(f,{key:2},[d.value?(o(),n("div",{key:0,class:I([{"bg-green-900 text-white border-green-700":c.value==="success","bg-red-900 text-white border-red-700":c.value==="error"},"p-4 rounded-md border flex items-start"])},[c.value==="success"?(o(),n("svg",xe,t[17]||(t[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(o(),n("svg",ge,t[18]||(t[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))),e("span",null,u(d.value),1),e("button",{onClick:t[0]||(t[0]=s=>d.value=""),class:"ml-auto"},t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))],2)):N("",!0),T(E,{title:"Model Groups",icon:"layer-group","default-open":!0,class:"mt-6"},{default:U(()=>[e("div",be,[e("button",{type:"button",class:"btn btn-default",onClick:h,disabled:w.value},[w.value?(o(),n("span",he,t[20]||(t[20]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),z(" Refreshing... ")]))):(o(),n("span",ke,"Refresh"))],8,ye),e("button",{type:"button",class:"btn btn-primary",onClick:ee}," Add Group ")]),e("div",we,[e("table",_e,[t[21]||(t[21]=e("thead",{class:"bg-background-mute"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Name"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Me,[(o(!0),n(f,null,k(M.value,s=>(o(),n("tr",{key:s.name,class:"hover:bg-background-mute"},[e("td",Ce,u(s.name),1),e("td",Ae,[e("div",je,[e("button",{type:"button",class:"px-3 py-1 bg-btn-default text-white rounded hover:bg-btn-default-hover text-sm",onClick:r=>te(s.name)}," Rename ",8,ze),e("button",{type:"button",class:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm",onClick:r=>se(s.name)}," Delete ",8,Ge)])])]))),128))])])])]),_:1}),T(E,{title:"Models by Group",icon:"cubes","default-open":!0,class:"mt-6"},{default:U(()=>[e("div",Ve,[e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=s=>le())}," Add Model ")]),M.value.length?(o(),n("div",Be,[(o(!0),n(f,null,k(M.value,s=>(o(),ce(E,{key:s.name,title:`${s.name} (${s.models.length})`,icon:"folder","default-open":!1},{default:U(()=>[e("div",$e,[e("table",Ne,[t[22]||(t[22]=e("thead",{class:"bg-background-mute"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Name"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"URL"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Tags"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Size"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Te,[(o(!0),n(f,null,k(s.models,r=>(o(),n("tr",{key:r.dest||r.git,class:"hover:bg-background-mute"},[e("td",Ue,[e("span",{class:I({"text-red-500 font-bold":Y(r)})},u(W(r)),3)]),e("td",Le,u(r.type),1),e("td",Ee,[r.src?(o(),n("a",{key:0,href:r.src,target:"_blank",rel:"noopener noreferrer",class:"text-blue-400 hover:text-blue-300",title:r.src},[T(a,{icon:"external-link-alt",class:"w-4 h-4"})],8,Se)):(o(),n("span",De,"-"))]),e("td",Fe,[e("div",Re,[(o(!0),n(f,null,k(P(r),j=>(o(),n("span",{key:j,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-blue-700 text-white"},u(j),1))),128))])]),e("td",He,u(r.size?(r.size/1024/1024).toFixed(2)+" MB":"-"),1),e("td",Oe,[e("div",qe,[e("button",{type:"button",class:"px-3 py-1 bg-btn-default text-white rounded hover:bg-btn-default-hover text-sm",onClick:j=>oe(r)}," Edit ",8,Ie),e("button",{type:"button",class:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm",onClick:j=>ne(r)}," Delete ",8,Ke)])])]))),128))])])])]),_:2},1032,["title"]))),128))])):(o(),n("div",Je,t[23]||(t[23]=[e("svg",{class:"w-16 h-16 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),e("p",{class:"text-lg"},"No model groups.",-1)])))]),_:1})],64)),g.value?(o(),n("div",Qe,[e("div",We,[e("div",{class:"fixed inset-0 transition-opacity",onClick:t[2]||(t[2]=s=>g.value=!1)},t[24]||(t[24]=[e("div",{class:"absolute inset-0 bg-black opacity-50"},null,-1)])),t[27]||(t[27]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},null,-1)),t[28]||(t[28]=z("​ ")),e("div",Ye,[e("div",Pe,[e("h3",Xe,u(J.value),1),e("form",{onSubmit:L(R,["prevent"])},[e("div",Ze,[t[25]||(t[25]=e("label",{for:"group-name",class:"form-label"},"Group Name",-1)),m(e("input",{id:"group-name","onUpdate:modelValue":t[3]||(t[3]=s=>b.name=s),type:"text",class:"form-input w-full",required:""},null,512),[[v,b.name]])])],32)]),e("div",et,[e("button",{type:"button",class:"btn btn-primary ml-2",onClick:R,disabled:V.value},[V.value?(o(),n("span",st,t[26]||(t[26]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),z(" Saving... ")]))):(o(),n("span",lt,u(C.value?"Rename":"Add"),1))],8,tt),e("button",{type:"button",class:"btn btn-default",onClick:t[4]||(t[4]=s=>g.value=!1)}," Cancel ")])])])])):N("",!0),y.value?(o(),n("div",ot,[e("div",nt,[e("div",{class:"fixed inset-0 transition-opacity",onClick:t[5]||(t[5]=s=>y.value=!1)},t[29]||(t[29]=[e("div",{class:"absolute inset-0 bg-black opacity-50"},null,-1)])),t[41]||(t[41]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},null,-1)),t[42]||(t[42]=z("​ ")),e("div",at,[e("div",it,[e("h3",rt,u(Q.value),1),e("form",{onSubmit:L(O,["prevent"]),class:"space-y-4"},[e("div",null,[t[31]||(t[31]=e("label",{class:"form-label"},"Group Name",-1)),m(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.group=s),class:"form-input",required:""},[t[30]||(t[30]=e("option",{value:"",disabled:""},"Select a group",-1)),(o(!0),n(f,null,k(M.value,s=>(o(),n("option",{key:s.name,value:s.name},u(s.name),9,dt))),128))],512),[[de,i.group]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"form-label"},"URL",-1)),m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>i.url=s),type:"text",class:"form-input",placeholder:"Model URL"},null,512),[[v,i.url]])]),e("div",null,[t[33]||(t[33]=e("label",{class:"form-label"},"Destination",-1)),m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>i.dest=s),type:"text",class:"form-input",placeholder:"Destination path"},null,512),[[v,i.dest]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"form-label"},"Git",-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>i.git=s),type:"text",class:"form-input",placeholder:"Git repository URL"},null,512),[[v,i.git]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"form-label"},"Type",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>i.type=s),type:"text",class:"form-input",placeholder:"Model type"},null,512),[[v,i.type]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"form-label"},"Tags",-1)),e("div",ut,[(o(!0),n(f,null,k(i.tags,(s,r)=>(o(),n("div",{key:r,class:"bg-background-mute px-2 py-1 rounded flex items-center"},[e("span",pt,u(s),1),e("button",{type:"button",onClick:j=>Z(r),class:"text-text-light-muted hover:text-text-light"},t[36]||(t[36]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ct)]))),128)),m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>_.value=s),onKeydown:ue(L(X,["prevent"]),["enter"]),type:"text",class:"bg-transparent border-none focus:outline-none text-text-light flex-1",placeholder:"Add a tag..."},null,40,mt),[[v,_.value]])])]),e("div",null,[t[38]||(t[38]=e("label",{class:"form-label"},"Hash",-1)),m(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>i.hash=s),type:"text",class:"form-input",placeholder:"Hash"},null,512),[[v,i.hash]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"form-label"},"Size (bytes)",-1)),m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>i.size=s),type:"number",min:"0",class:"form-input"},null,512),[[v,i.size,void 0,{number:!0}]])])],32)]),e("div",vt,[e("button",{type:"button",class:"btn btn-primary ml-2",onClick:O,disabled:B.value},[B.value?(o(),n("span",xt,t[40]||(t[40]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),z(" Saving... ")]))):(o(),n("span",gt,u(A.value?"Save":"Add"),1))],8,ft),e("button",{type:"button",class:"btn btn-default",onClick:t[14]||(t[14]=s=>y.value=!1)}," Cancel ")])])])])):N("",!0)])}}},wt=ae(bt,[["__scopeId","data-v-54f568bf"]]);export{wt as default};
