import{_ as b,b as w,d as e,e as p,f as n,J as y,B as x,t as f,K as P,w as d,g as i,v as h,X as c,O as g,z as v,A as m}from"./index-Cu1PUPqU.js";const C={name:"ChangePasswordComponent",data(){return{form:{oldUsername:"",oldPassword:"",newUsername:"",newPassword:""},confirmPassword:"",loading:!1,message:"",messageType:"info",showCurrentPassword:!1,showNewPassword:!1,showConfirmPassword:!1}},computed:{passwordsMatch(){return this.form.newPassword===this.confirmPassword},isFormValid(){return this.form.oldUsername.trim()&&this.form.oldPassword&&this.form.newUsername.trim()&&this.form.newPassword.length>=4&&this.passwordsMatch},messageClass(){const l="border-l-4";switch(this.messageType){case"success":return`${l} border-green-500 bg-green-900/20 text-green-300`;case"error":return`${l} border-red-500 bg-red-900/20 text-red-300`;case"warning":return`${l} border-yellow-500 bg-yellow-900/20 text-yellow-300`;default:return`${l} border-secondary bg-blue-900/20 text-secondary`}},messageIcon(){switch(this.messageType){case"success":return"check-circle";case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";default:return"info-circle"}}},methods:{async changePassword(){var l,s;if(this.isFormValid){this.loading=!0,this.message="";try{await v.post("/models/change_user",{old_username:this.form.oldUsername,old_password:this.form.oldPassword,new_username:this.form.newUsername,new_password:this.form.newPassword}),this.showMessage("Password changed successfully! Please log in again with your new credentials.","success"),this.resetForm(),setTimeout(()=>{localStorage.removeItem("auth_token"),this.$router.push({name:"login"})},2e3)}catch(u){console.error("Error changing password:",u),((l=u.response)==null?void 0:l.status)===401?this.showMessage("Invalid current username or password.","error"):((s=u.response)==null?void 0:s.status)===409?this.showMessage("Username already exists. Please choose a different username.","error"):this.showMessage("Failed to change password. Please try again.","error")}finally{this.loading=!1}}},resetForm(){this.form={oldUsername:"",oldPassword:"",newUsername:"",newPassword:""},this.confirmPassword="",this.message="",this.showCurrentPassword=!1,this.showNewPassword=!1,this.showConfirmPassword=!1},showMessage(l,s="info"){this.message=l,this.messageType=s}}},U={class:"space-y-6 p-4 bg-background"},k={class:"card"},_={class:"flex items-center gap-3 mb-6"},N={class:"form-label"},M={class:"form-label"},V={class:"relative"},F=["type"],T={class:"form-label"},I={class:"form-label"},q={class:"relative"},B=["type"],A={class:"form-label"},S={class:"relative"},D=["type"],z={key:0,class:"text-sm text-red-400 mt-1"},E={class:"flex gap-4"},J=["disabled"],K={class:"mt-8 p-4 bg-background-mute rounded-lg"},O={class:"font-semibold text-text-light mb-2 flex items-center gap-2"};function R(l,s,u,X,o,a){const t=y("FontAwesomeIcon");return m(),w("div",U,[e("div",k,[e("div",_,[n(t,{icon:"key",class:"text-primary text-2xl"}),s[10]||(s[10]=e("h1",{class:"text-2xl font-bold text-heading"},"Change Password",-1))]),o.message?(m(),w("div",{key:0,class:x([a.messageClass,"p-4 rounded-lg mb-6 flex items-center gap-2"])},[n(t,{icon:a.messageIcon},null,8,["icon"]),e("span",null,f(o.message),1)],2)):p("",!0),e("form",{onSubmit:s[9]||(s[9]=P((...r)=>a.changePassword&&a.changePassword(...r),["prevent"])),class:"space-y-6"},[e("div",null,[e("label",N,[n(t,{icon:"user",class:"mr-2"}),s[11]||(s[11]=i(" Current Username "))]),d(e("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>o.form.oldUsername=r),type:"text",class:"form-input",required:"",autocomplete:"username"},null,512),[[h,o.form.oldUsername]])]),e("div",null,[e("label",M,[n(t,{icon:"lock",class:"mr-2"}),s[12]||(s[12]=i(" Current Password "))]),e("div",V,[d(e("input",{"onUpdate:modelValue":s[1]||(s[1]=r=>o.form.oldPassword=r),type:o.showCurrentPassword?"text":"password",class:"form-input pr-12",required:"",autocomplete:"current-password"},null,8,F),[[c,o.form.oldPassword]]),e("button",{type:"button",onClick:s[2]||(s[2]=r=>o.showCurrentPassword=!o.showCurrentPassword),class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted hover:text-text-light"},[n(t,{icon:o.showCurrentPassword?"eye-slash":"eye"},null,8,["icon"])])])]),e("div",null,[e("label",T,[n(t,{icon:"user-edit",class:"mr-2"}),s[13]||(s[13]=i(" New Username "))]),d(e("input",{"onUpdate:modelValue":s[3]||(s[3]=r=>o.form.newUsername=r),type:"text",class:"form-input",required:"",autocomplete:"username"},null,512),[[h,o.form.newUsername]])]),e("div",null,[e("label",I,[n(t,{icon:"key",class:"mr-2"}),s[14]||(s[14]=i(" New Password "))]),e("div",q,[d(e("input",{"onUpdate:modelValue":s[4]||(s[4]=r=>o.form.newPassword=r),type:o.showNewPassword?"text":"password",class:"form-input pr-12",required:"",autocomplete:"new-password",minlength:"4"},null,8,B),[[c,o.form.newPassword]]),e("button",{type:"button",onClick:s[5]||(s[5]=r=>o.showNewPassword=!o.showNewPassword),class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted hover:text-text-light"},[n(t,{icon:o.showNewPassword?"eye-slash":"eye"},null,8,["icon"])])]),s[15]||(s[15]=e("p",{class:"text-sm text-text-muted mt-1"},"Minimum 4 characters",-1))]),e("div",null,[e("label",A,[n(t,{icon:"shield-alt",class:"mr-2"}),s[16]||(s[16]=i(" Confirm New Password "))]),e("div",S,[d(e("input",{"onUpdate:modelValue":s[6]||(s[6]=r=>o.confirmPassword=r),type:o.showConfirmPassword?"text":"password",class:"form-input pr-12",required:"",minlength:"4"},null,8,D),[[c,o.confirmPassword]]),e("button",{type:"button",onClick:s[7]||(s[7]=r=>o.showConfirmPassword=!o.showConfirmPassword),class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted hover:text-text-light"},[n(t,{icon:o.showConfirmPassword?"eye-slash":"eye"},null,8,["icon"])])]),o.confirmPassword&&!a.passwordsMatch?(m(),w("p",z," Passwords do not match ")):p("",!0)]),e("div",E,[e("button",{type:"submit",disabled:o.loading||!a.isFormValid,class:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[o.loading?(m(),g(t,{key:0,icon:"spinner",class:"animate-spin"})):(m(),g(t,{key:1,icon:"save"})),i(" "+f(o.loading?"Changing...":"Change Password"),1)],8,J),e("button",{type:"button",onClick:s[8]||(s[8]=(...r)=>a.resetForm&&a.resetForm(...r)),class:"btn btn-default flex items-center gap-2"},[n(t,{icon:"undo"}),s[17]||(s[17]=i(" Reset "))])])],32),e("div",K,[e("h3",O,[n(t,{icon:"info-circle",class:"text-secondary"}),s[18]||(s[18]=i(" Security Tips "))]),s[19]||(s[19]=e("ul",{class:"text-sm text-text-muted space-y-1"},[e("li",null,"• Use a strong, unique password"),e("li",null,"• Include a mix of letters, numbers, and symbols"),e("li",null,"• Avoid using personal information"),e("li",null,"• Your password is encrypted and cannot be recovered")],-1))])])])}const j=b(C,[["render",R]]);export{j as default};
