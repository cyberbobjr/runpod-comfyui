import{d as Re,r as _,o as le,a as Oe,b as c,e as i,f as t,j as n,g as Y,h as B,i as a,u as G,F as q,t as b,n as oe,T as Ie,w as R,z,U as ze,C as O,D as I,m as me,V as Ee,_ as ne,W as Q,A as E,k as ve,X as V,S as Le,c as H,Y as xe,M as J,N as be,Z as pe,O as We}from"./index-jy5-nOjD.js";import{a as Ve,_ as K}from"./CommonModal.vue_vue_type_script_setup_true_lang-DHWmlz8S.js";const Ke={class:"relative"},Ge=["disabled"],qe={class:"flex items-center"},He={key:0,class:"p-2"},Ye=["onClick"],Ze={key:1,class:"p-4 text-text-muted text-center"},Xe=Re({__name:"FormDropdownComponent",props:{label:{},icon:{},items:{},itemKey:{type:[Function,String],default:"id"},itemLabel:{type:[Function,String],default:"label"},placeholder:{default:"No items available"},disabled:{type:Boolean,default:!1},widthClass:{default:"w-full"}},emits:["select"],setup(U,{emit:f}){const k=U,p=f,g=_(!1),F=_(),y=_();function D(w){return w!==Object(w)?w:typeof k.itemKey=="function"?k.itemKey(w):w[k.itemKey]}function h(w){return w!==Object(w)?w:typeof k.itemLabel=="function"?k.itemLabel(w):w[k.itemLabel]}function A(){k.disabled||(g.value=!g.value,g.value&&Ee(()=>{}))}function $(){g.value=!1}function P(w){p("select",w),$()}function C(w){const S=w.target;F.value&&!F.value.contains(S)&&y.value&&!y.value.contains(S)&&$()}return le(()=>{document.addEventListener("mousedown",C)}),Oe(()=>{document.removeEventListener("mousedown",C)}),(w,S)=>(i(),c("div",Ke,[t("button",{ref_key:"buttonRef",ref:y,type:"button",class:"form-input w-full text-left flex items-center justify-between cursor-pointer",disabled:w.disabled,onClick:A},[t("span",qe,[w.icon?(i(),Y(G(q),{key:0,icon:w.icon,class:"mr-2"},null,8,["icon"])):B("",!0),a(" "+b(w.label),1)]),n(G(q),{icon:g.value?"chevron-up":"chevron-down",class:oe(["transition-transform duration-200",g.value?"rotate-180":"rotate-0"])},null,8,["icon","class"])],8,Ge),n(Ie,{name:"dropdown-fade-updown","enter-active-class":"transition duration-200 ease-in","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-out","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-2"},{default:R(()=>[z(t("div",{ref_key:"dropdownRef",ref:F,class:oe(["absolute z-10 mt-1 bg-background-soft border border-border rounded-lg shadow-lg max-h-60 overflow-y-auto",w.widthClass])},[w.items.length>0?(i(),c("div",He,[(i(!0),c(O,null,I(w.items,s=>me(w.$slots,"default",{key:D(s),item:s,select:()=>P(s)},()=>[t("div",{class:"flex items-center px-3 py-2 hover:bg-background-mute cursor-pointer rounded",onClick:d=>P(s)},[n(G(q),{icon:"file-code",class:"mr-2 text-blue-600"}),t("span",null,b(h(s)),1)],8,Ye)])),128))])):(i(),c("div",Ze,[me(w.$slots,"empty",{},()=>[n(G(q),{icon:"info-circle",class:"mr-1"}),a(b(w.placeholder),1)])]))],2),[[ze,g.value]])]),_:3})]))}}),Je={name:"ModelSelectorModal",components:{FontAwesomeIcon:q,CommonModal:Ve},props:{show:{type:Boolean,required:!0},currentProfileName:{type:String,default:""},groupedModels:{type:Object,required:!0},selectedModels:{type:Array,required:!0},popularTags:{type:Array,default:()=>[]},filterPlaceholder:{type:String,default:"Enter tags to filter models (e.g., base, fp8, nsfw...)"}},emits:["close","update:selectedModels","apply-selection"],setup(U,{emit:f}){const k=_(!1),p=_(""),g=_([...U.selectedModels]);Le(()=>U.selectedModels,s=>{g.value=[...s]});const F=H(()=>{const s=p.value.trim().toLowerCase();if(!s)return U.groupedModels;const d={};if(s.includes(",")){const v=s.split(",").map(x=>x.trim()).filter(Boolean);for(const[x,m]of Object.entries(U.groupedModels)){const M=m.filter(j=>{const r=[j.displayName,j.name,j.id,j.dest,j.url].some(W=>W&&W.toLowerCase().includes(s)),ee=j.tags&&v.some(W=>j.tags.map(Z=>Z.toLowerCase()).includes(W));return r||ee});M.length>0&&(d[x]=M)}}else for(const[v,x]of Object.entries(U.groupedModels)){const m=x.filter(M=>[M.displayName,M.name,M.id,M.dest,M.url].some(T=>T&&T.toLowerCase().includes(s))||M.tags&&M.tags.some(T=>T.toLowerCase().includes(s)));m.length>0&&(d[v]=m)}return d}),y=H(()=>Object.values(F.value).reduce((s,d)=>s+d.length,0));function D(){k.value=!k.value}function h(){p.value=""}function A(s){const d=p.value.split(",").map(v=>v.trim()).filter(Boolean);d.includes(s)||d.push(s),p.value=d.join(", ")}function $(s){const d=x=>x.hash||x.dest||x.url,v=d(s);return g.value.some(x=>d(x)===v)}function P(s){const d=m=>m.hash||m.dest||m.url,v=d(s),x=g.value.findIndex(m=>d(m)===v);x===-1?g.value.push(s):g.value.splice(x,1),f("update:selectedModels",g.value)}function C(s){if(s.displayName)return s.displayName;if(s.name)return s.name;if(s.id)return s.id;if(s.dest){const d=s.dest.match(/([^/\\]+)$/);if(d)return d[1]}if(s.url){const d=s.url.match(/([^/\\]+)$/);if(d)return d[1]}return"Unnamed Model"}function w(s){if(!s)return"";const d=Math.floor(Math.log(s)/Math.log(1024));return(s/Math.pow(1024,d)).toFixed(2)+" "+["B","KB","MB","GB","TB"][d]}function S(){f("apply-selection",g.value)}return{showFilterSection:k,modelFilter:p,filteredGroupedModels:F,filteredModelsCount:y,toggleFilterSection:D,clearModelFilter:h,addTagToFilter:A,isModelSelected:$,toggleModelSelection:P,getModelDisplayName:C,formatFileSize:w,applySelection:S,localSelectedModels:g}}},Qe={class:"border-b border-border bg-background-mute"},et={class:"flex items-center"},tt={key:0,class:"ml-2 text-sm text-blue-600"},st={key:0,class:"px-4 pb-4"},ot={class:"flex items-center space-x-4"},lt={class:"flex-1"},nt={class:"form-label text-sm flex items-center mb-1"},rt=["placeholder"],it={class:"flex flex-col"},at=["disabled"],dt={class:"text-xs text-text-muted text-center"},ct={key:0,class:"mt-3"},ut={class:"flex flex-wrap gap-1"},ft=["onClick"],mt={class:"text-md font-medium text-text-light mb-3 flex items-center"},pt={class:"ml-2 text-sm text-text-muted"},vt={class:"grid grid-cols-1 gap-2"},xt=["onClick"],bt=["checked"],wt={class:"flex-1 min-w-0"},gt={class:"text-sm font-medium text-text-light"},ht={class:"text-xs text-text-muted"},yt={class:"inline-flex items-center mr-2"},kt={key:0,class:"inline-flex items-center mr-2"},_t={key:1,class:"inline-flex items-center"},Ct={key:0,class:"text-center py-8"};function $t(U,f,k,p,g,F){const y=Q("FontAwesomeIcon"),D=Q("CommonModal");return i(),Y(D,{show:k.show,onClose:f[6]||(f[6]=h=>U.$emit("close"))},{title:R(()=>f[7]||(f[7]=[a(" Select Models ")])),default:R(()=>[t("div",Qe,[t("button",{type:"button",class:"w-full px-4 py-3 flex items-center justify-between hover:bg-background transition-colors",onClick:f[0]||(f[0]=(...h)=>p.toggleFilterSection&&p.toggleFilterSection(...h))},[t("div",et,[n(y,{icon:"filter",class:"mr-2"}),f[8]||(f[8]=t("span",{class:"font-medium text-text-light"},"Filter Models",-1)),p.modelFilter?(i(),c("span",tt," ("+b(p.filteredModelsCount)+" models) ",1)):B("",!0)]),n(y,{icon:p.showFilterSection?"chevron-up":"chevron-down",class:"text-text-muted"},null,8,["icon"])]),p.showFilterSection?(i(),c("div",st,[t("div",ot,[t("div",lt,[t("label",nt,[n(y,{icon:"search",class:"mr-2"}),f[9]||(f[9]=a("Filter by Name or Tags "))]),z(t("input",{type:"text",class:"form-input w-full text-sm","onUpdate:modelValue":f[1]||(f[1]=h=>p.modelFilter=h),placeholder:k.filterPlaceholder},null,8,rt),[[E,p.modelFilter]]),f[10]||(f[10]=t("p",{class:"text-xs text-text-muted mt-1"}," Type a model name or separate multiple tags with commas. Models matching the name or any of these tags will be shown. ",-1))]),t("div",it,[t("button",{type:"button",class:"btn btn-sm btn-outline mb-2",onClick:f[2]||(f[2]=(...h)=>p.clearModelFilter&&p.clearModelFilter(...h)),disabled:!p.modelFilter},[n(y,{icon:"times",class:"mr-1"}),f[11]||(f[11]=a("Clear "))],8,at),t("div",dt,b(p.filteredModelsCount)+" models ",1)])]),k.popularTags&&k.popularTags.length>0?(i(),c("div",ct,[f[12]||(f[12]=t("label",{class:"text-xs text-text-muted mb-2 block"},"Popular tags:",-1)),t("div",ut,[(i(!0),c(O,null,I(k.popularTags,h=>(i(),c("button",{key:h,type:"button",class:"px-2 py-1 text-xs rounded bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors",onClick:A=>p.addTagToFilter(h)},b(h),9,ft))),128))])])):B("",!0)])):B("",!0)]),t("div",{class:"p-4 overflow-y-auto",style:ve({"max-height":p.showFilterSection?"45vh":"55vh"})},[(i(!0),c(O,null,I(p.filteredGroupedModels,(h,A)=>(i(),c("div",{key:A,class:"mb-6"},[t("h4",mt,[n(y,{icon:"folder",class:"mr-2"}),a(b(A)+" ",1),t("span",pt,"("+b(h.length)+" models)",1)]),t("div",vt,[(i(!0),c(O,null,I(h,($,P)=>(i(),c("div",{key:P,class:"flex items-center p-3 border border-border rounded hover:bg-background-mute cursor-pointer",onClick:C=>p.toggleModelSelection($)},[t("input",{type:"checkbox",checked:p.isModelSelected($),class:"mr-3",onClick:f[3]||(f[3]=V(()=>{},["stop"]))},null,8,bt),t("div",wt,[t("div",gt,b(p.getModelDisplayName($)),1),t("div",ht,[t("span",yt,[n(y,{icon:"tag",class:"mr-1"}),a(b($.type),1)]),$.tags&&$.tags.length>0?(i(),c("span",kt,[n(y,{icon:"tags",class:"mr-1"}),a(b($.tags.join(", ")),1)])):B("",!0),$.size?(i(),c("span",_t,[n(y,{icon:"database",class:"mr-1"}),a(b(p.formatFileSize($.size)),1)])):B("",!0)])])],8,xt))),128))])]))),128)),Object.keys(p.filteredGroupedModels).length===0?(i(),c("div",Ct,[n(y,{icon:"search",class:"text-4xl text-text-muted mb-4"}),f[13]||(f[13]=t("h4",{class:"text-lg font-medium text-text-light mb-2"},"No models found",-1)),f[14]||(f[14]=t("p",{class:"text-text-muted"}," No models match the current filter criteria. Try adjusting your tag filters. ",-1))])):B("",!0)],4)]),footer:R(()=>[t("button",{type:"button",class:"btn btn-secondary",onClick:f[4]||(f[4]=h=>U.$emit("close"))}," Cancel "),t("button",{type:"button",class:"btn btn-primary",onClick:f[5]||(f[5]=(...h)=>p.applySelection&&p.applySelection(...h))}," Apply Selection ("+b(p.localSelectedModels.length)+" selected) ",1)]),_:1},8,["show"])}const Mt=ne(Je,[["render",$t]]),Bt={class:"space-y-6"},Ft={class:"flex items-center justify-between"},St={class:"flex items-center"},Pt={class:"text-xl font-semibold text-text-light"},jt={key:0},Tt={key:1},Nt={class:"flex items-center space-x-2"},Dt={key:0,class:"text-sm text-blue-600 flex items-center"},Ut={key:1,class:"text-sm text-green-600 flex items-center"},At={class:"text-lg font-medium text-text-light flex items-center"},Rt={class:"space-y-4"},Ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},It={class:"form-label flex items-center"},zt={class:"form-label flex items-center"},Et={class:"form-label flex items-center"},Lt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wt={class:"form-label flex items-center"},Vt={class:"form-label flex items-center"},Kt={class:"form-label flex items-center"},Gt={class:"text-lg font-medium text-text-light flex items-center"},qt={key:0,class:"ml-2 text-sm text-blue-600"},Ht={class:"space-y-4"},Yt={class:"bg-background-soft border border-border rounded-lg p-3 min-h-[60px]"},Zt={key:0,class:"flex flex-wrap gap-2"},Xt=["onClick"],Jt={key:1,class:"text-text-muted text-sm flex items-center"},Qt={key:0,class:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},es={class:"text-yellow-600 mb-2 flex items-center"},ts={class:"flex flex-wrap gap-2"},ss=["onClick"],os={class:"flex"},ls={class:"text-lg font-medium text-text-light flex items-center"},ns={key:0,class:"ml-2 text-sm text-green-600"},rs={key:0,class:"mt-4"},is={class:"border border-border rounded-lg overflow-hidden"},as={class:"bg-background-mute border-b border-border"},ds={class:"flex overflow-x-auto"},cs={class:"flex items-center"},us=["onClick"],fs={class:"flex items-center min-w-0 mr-2"},ms={class:"truncate"},ps={class:"ml-1 text-xs opacity-75 flex-shrink-0"},vs=["onClick"],xs={key:0,class:"p-4 space-y-4"},bs={class:"form-label flex items-center"},ws={class:"bg-background-soft border border-border rounded-lg p-3"},gs={class:"grid grid-cols-2 gap-4 text-sm"},hs={class:"flex items-center"},ys={class:"ml-1 font-medium text-text-light"},ks={class:"flex items-center"},_s={class:"ml-1 font-medium text-text-light"},Cs={class:"flex justify-between items-center mb-2"},$s={class:"form-label flex items-center mb-0"},Ms={class:"bg-background-soft border border-border rounded-lg p-3 min-h-[60px] mb-2"},Bs={key:0,class:"space-y-2"},Fs={class:"flex-1 min-w-0"},Ss={class:"text-sm font-medium text-text-light truncate"},Ps={class:"text-xs text-text-muted"},js={class:"inline-flex items-center mr-2"},Ts={key:0,class:"inline-flex items-center mr-2"},Ns={key:1,class:"inline-flex items-center"},Ds=["onClick"],Us={key:1,class:"text-text-muted text-sm flex items-center"},As={key:1,class:"p-8 text-center"},Rs={class:"flex justify-between items-center"},Os={class:"flex space-x-3"},Is={type:"submit",class:"btn btn-primary"},zs={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]"},Es={class:"bg-background rounded-lg shadow-xl max-w-md w-full mx-4"},Ls={class:"flex justify-between items-center p-4 border-b border-border"},Ws={class:"p-4"},Vs={class:"form-label flex items-center mb-2"},Ks={class:"flex justify-end space-x-3 p-4 border-t border-border bg-background-mute"},Gs=["disabled"],qs={__name:"BundleEditor",props:{bundleId:{type:[String,null],default:""}},emits:["saved","cancel"],setup(U,{emit:f}){const k=U,p=f,{success:g,error:F,confirm:y}=be(),D=xe(),h=_(!0),A=_({top:"0px",left:"0px"}),$=_(!1),P=_(""),C=_(""),w=_(!1),S=_(!1),s=_(""),d=_([]),v=_(!1),x=_(""),m=_(""),M=_(""),j=_([]),T=_({}),r=_({id:"",name:"",description:"",version:"1.0.0",author:"",website:"",workflows:[],hardware_profiles:{}});le(async()=>{if(k.bundleId){const e=D.getBundleById(k.bundleId);r.value={id:e.id,name:e.name,description:e.description,version:e.version||"1.0.0",author:e.author||"",website:e.website||"",workflows:e.workflows||[],hardware_profiles:e.hardware_profiles||{}}}await re(),await he();const l=Object.keys(r.value.hardware_profiles);l.length>0&&(m.value=l[0]),document.addEventListener("click",e=>{e.target.closest(".relative")||ee(),W(e)})});const ee=()=>{w.value=!1,C.value=""},W=l=>{l.target.closest(".profile-actions-container")||(C.value="")},Z=H(()=>r.value.workflows?r.value.workflows.filter(l=>!j.value.includes(l)):[]),we=H(()=>j.value.filter(l=>!r.value.workflows.includes(l))),ge=H(()=>{const l={};for(const e of Object.values(T.value))for(const o of e)if(o.tags&&o.tags.length>0)for(const u of o.tags)l[u]=(l[u]||0)+1;return Object.entries(l).sort((e,o)=>o[1]-e[1]).slice(0,8).map(([e])=>e)}),re=async()=>{try{const l=await J.get("/workflows/");j.value=l.data||[]}catch(l){console.error("Error loading workflows:",l),F("Failed to load workflows")}},he=async()=>{var l;try{const e=await J.get("/jsonmodels/");T.value=((l=e.data)==null?void 0:l.groups)||{}}catch(e){console.error("Error loading models:",e),F("Failed to load model groups")}},ye=async l=>{try{if(await y(`Are you sure you want to remove "${l}" from this bundle?`,"Confirm Removal")){const o=r.value.workflows.indexOf(l);o!==-1&&(r.value.workflows.splice(o,1),g(`Workflow "${l}" removed from bundle`))}}catch(e){F("Failed to remove workflow from bundle: "+e.message)}},ie=()=>{S.value=!1,s.value="",d.value=[],M.value="",v.value=!1},ke=async l=>{const e=l.target.files[0];e&&(await Ae(e),l.target.value="")},_e=()=>{document.getElementById("workflow-file").click()},Ce=l=>l.dest?l.dest.split("/").pop():l.url?l.url.split("/").pop():"Unknown model",te=l=>{if(!l)return"Unknown size";const e=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(l)/Math.log(1024));return`${(l/Math.pow(1024,o)).toFixed(1)} ${e[o]}`},$e=l=>{var e;s.value=l,d.value=[...((e=r.value.hardware_profiles[l])==null?void 0:e.models)||[]],M.value="",v.value=!1,S.value=!0},Me=()=>{r.value.hardware_profiles[s.value]||(r.value.hardware_profiles[s.value]={description:"",models:[]}),r.value.hardware_profiles[s.value].models=[...d.value],ie()},Be=(l,e)=>{var o;(o=r.value.hardware_profiles[l])!=null&&o.models&&r.value.hardware_profiles[l].models.splice(e,1)},ae=l=>!l.models||l.models.length===0?0:l.models.reduce((e,o)=>e+(o.size||0),0),Fe=(l,e)=>{if(C.value===l)C.value="";else{C.value=l;const o=e.target.getBoundingClientRect();A.value={top:o.bottom+window.scrollY+4+"px",left:o.right-150+"px"}}},Se=l=>{x.value=l,P.value=l,C.value="",$.value=!0,nextTick(()=>{const e=document.querySelector('input[ref="renameProfileInput"]');e&&(e.focus(),e.select())})},de=()=>{if(x.value&&P.value.trim()){const l=P.value.trim();l!==x.value&&Te(x.value,l)}X()},X=()=>{x.value="",P.value="",$.value=!1},Pe=l=>{const e=r.value.hardware_profiles[l];if(!e)return;let o=`${l} Copy`,u=1;for(;r.value.hardware_profiles[o];)o=`${l} Copy ${u}`,u++;r.value.hardware_profiles[o]={description:e.description,models:[...e.models||[]]},m.value=o,C.value="",g(`Profile "${l}" cloned as "${o}"`)},ce=()=>{let l="New Profile",e=1;for(;r.value.hardware_profiles[l];)l=`New Profile ${e}`,e++;r.value.hardware_profiles[l]={description:"",models:[]},m.value=l,C.value=""},je=async l=>{try{if(await y(`Are you sure you want to delete profile "${l}"?`,"Confirm Delete")){if(delete r.value.hardware_profiles[l],m.value===l){const o=Object.keys(r.value.hardware_profiles);m.value=o.length>0?o[0]:""}C.value="",g(`Profile "${l}" deleted successfully`)}}catch(e){F("Failed to delete profile: "+e.message)}},Te=(l,e)=>{const o=e.trim();if(!o||o===l){x.value="";return}if(r.value.hardware_profiles[o]){F(`Profile name "${o}" already exists`);return}const u=r.value.hardware_profiles[l];r.value.hardware_profiles[o]={description:u.description,models:[...u.models||[]]},delete r.value.hardware_profiles[l],m.value=o,C.value="",g(`Profile renamed from "${l}" to "${o}"`)},Ne=l=>{r.value.workflows.includes(l)||r.value.workflows.push(l),w.value=!1},De=l=>{const e=r.value.workflows.indexOf(l);e!==-1&&r.value.workflows.splice(e,1)};function ue(){fe(),p("cancel")}async function Ue(){var l,e;try{const o={name:r.value.name,description:r.value.description,version:r.value.version,author:r.value.author||null,website:r.value.website||null,workflows:r.value.workflows,hardware_profiles:r.value.hardware_profiles};if(r.value.id)await D.updateBundle(r.value.id,o),g(`Bundle "${r.value.name}" updated successfully`);else{const u=await D.createBundle(o);r.value.id=u.id,g(`Bundle "${r.value.name}" created successfully`)}await D.fetchBundles()}catch(o){F("Failed to save bundle: "+(((e=(l=o.response)==null?void 0:l.data)==null?void 0:e.detail)||o.message))}}const Ae=async l=>{var e,o;try{const u=new FormData;u.append("workflow_file",l),await J.post("/workflows/upload",u,{headers:{"Content-Type":"multipart/form-data"}}),g(`Workflow "${l.name}" uploaded successfully`),await re()}catch(u){console.error("Error uploading workflow:",u),F("Failed to upload workflow: "+(((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.detail)||u.message))}};function fe(){r.value={id:"",name:"",description:"",version:"1.0.0",author:"",website:"",workflows:[],hardware_profiles:{}}}return(l,e)=>{const o=Q("FontAwesomeIcon");return i(),c(O,null,[t("div",Bt,[n(K,null,{default:R(()=>[t("div",Ft,[t("div",St,[t("button",{type:"button",class:"btn btn-xs btn-secondary mr-4",onClick:ue,title:"Return to bundle list"},[n(o,{icon:"arrow-left",class:"mr-1"}),e[15]||(e[15]=a("Back "))]),t("h2",Pt,[n(o,{icon:"box-open",class:"mr-2"}),r.value.id?(i(),c("span",jt,"Edit Bundle: "+b(r.value.name),1)):(i(),c("span",Tt,"Create New Bundle"))])]),t("div",Nt,[r.value.id?(i(),c("span",Dt,[n(o,{icon:"edit",class:"mr-1"}),e[16]||(e[16]=a("Editing "))])):(i(),c("span",Ut,[n(o,{icon:"plus",class:"mr-1"}),e[17]||(e[17]=a("Creating "))]))])])]),_:1}),t("form",{onSubmit:V(Ue,["prevent"]),class:"space-y-6"},[n(K,null,{header:R(()=>[t("h4",At,[n(o,{icon:"info-circle",class:"mr-2"}),e[18]||(e[18]=a("General Information "))])]),default:R(()=>[t("div",Rt,[t("div",Ot,[t("div",null,[t("label",It,[n(o,{icon:"tag",class:"mr-2"}),e[19]||(e[19]=a("UUID "))]),z(t("input",{type:"text",class:"form-input w-full","onUpdate:modelValue":e[0]||(e[0]=u=>r.value.id=u),readonly:""},null,512),[[E,r.value.id]])]),t("div",null,[t("label",zt,[n(o,{icon:"tag",class:"mr-2"}),e[20]||(e[20]=a("Name "))]),z(t("input",{type:"text",class:"form-input w-full","onUpdate:modelValue":e[1]||(e[1]=u=>r.value.name=u),required:""},null,512),[[E,r.value.name]])]),t("div",null,[t("label",Et,[n(o,{icon:"code-branch",class:"mr-2"}),e[21]||(e[21]=a("Version "))]),z(t("input",{type:"text",class:"form-input w-full","onUpdate:modelValue":e[2]||(e[2]=u=>r.value.version=u),placeholder:"1.0.0",pattern:"^\\d+\\.\\d+\\.\\d+$",title:"Version must be in x.y.z format (e.g., 1.0.0)"},null,512),[[E,r.value.version]])])]),t("div",Lt,[t("div",null,[t("label",Wt,[n(o,{icon:"user",class:"mr-2"}),e[22]||(e[22]=a("Author "))]),z(t("input",{type:"text",class:"form-input w-full","onUpdate:modelValue":e[3]||(e[3]=u=>r.value.author=u),placeholder:"Bundle author"},null,512),[[E,r.value.author]])]),t("div",null,[t("label",Vt,[n(o,{icon:"globe",class:"mr-2"}),e[23]||(e[23]=a("Website "))]),z(t("input",{type:"url",class:"form-input w-full","onUpdate:modelValue":e[4]||(e[4]=u=>r.value.website=u),placeholder:"https://example.com"},null,512),[[E,r.value.website]])])]),t("div",null,[t("label",Kt,[n(o,{icon:"info",class:"mr-2"}),e[24]||(e[24]=a("Description "))]),z(t("textarea",{class:"form-input w-full","onUpdate:modelValue":e[5]||(e[5]=u=>r.value.description=u),rows:"3",placeholder:"Describe your bundle..."},null,512),[[E,r.value.description]])])])]),_:1}),n(K,null,{header:R(()=>[t("h4",Gt,[n(o,{icon:"sitemap",class:"mr-2"}),e[25]||(e[25]=a("Workflows ")),r.value.workflows.length>0?(i(),c("span",qt," ("+b(r.value.workflows.length)+" selected) ",1)):B("",!0)])]),default:R(()=>[t("div",Ht,[t("div",Yt,[r.value.workflows.length>0?(i(),c("div",Zt,[(i(!0),c(O,null,I(r.value.workflows,u=>(i(),c("span",{key:u,class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-600 text-white group"},[n(o,{icon:"file-code",class:"mr-1"}),a(b(u)+" ",1),t("button",{type:"button",class:"tag",onClick:V(N=>De(u),["stop"]),title:"Remove workflow"},[n(o,{icon:"times"})],8,Xt)]))),128))])):(i(),c("div",Jt,[n(o,{icon:"info-circle",class:"mr-1"}),e[26]||(e[26]=a("No workflows selected. Choose from the dropdown below. "))]))]),n(Xe,{label:"Add Workflows",icon:"plus-circle",items:we.value,onSelect:Ne},null,8,["items"]),Z.value.length>0?(i(),c("div",Qt,[t("div",es,[n(o,{icon:"exclamation-triangle",class:"mr-1"}),e[27]||(e[27]=t("strong",null,"Missing workflows:",-1)),e[28]||(e[28]=t("span",{class:"ml-1 text-sm"},"These workflows are referenced in this bundle but are not available in the system.",-1))]),t("div",ts,[(i(!0),c(O,null,I(Z.value,u=>(i(),c("span",{key:u,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800 group"},[n(o,{icon:"file-code",class:"mr-1"}),a(b(u)+" ",1),t("button",{type:"button",class:"ml-2 w-4 h-4 flex items-center justify-center rounded-full bg-yellow-400 hover:bg-red-500 text-yellow-800 hover:text-white text-xs transition-colors duration-200 flex-shrink-0",onClick:V(N=>ye(u),["stop"]),title:"Remove missing workflow"},[n(o,{icon:"times"})],8,ss)]))),128))])])):B("",!0),t("div",os,[t("input",{type:"file",class:"form-input flex-1 rounded-r-none",id:"workflow-file",onChange:ke,accept:".json"},null,32),t("button",{class:"btn btn-outline rounded-l-none border-l-0",type:"button",onClick:_e},[n(o,{icon:"upload",class:"mr-1"}),e[29]||(e[29]=a("Upload New Workflow "))])])])]),_:1}),n(K,null,{default:R(()=>{var u;return[t("div",{class:"flex justify-between items-center cursor-pointer p-1 -m-1 rounded hover:bg-background-soft transition-colors",onClick:e[6]||(e[6]=N=>h.value=!h.value)},[t("h4",ls,[n(o,{icon:"server",class:"mr-2"}),e[30]||(e[30]=a("Hardware Profiles & Models ")),Object.keys(r.value.hardware_profiles).length>0?(i(),c("span",ns," ("+b(Object.keys(r.value.hardware_profiles).length)+" profiles) ",1)):B("",!0)]),n(o,{icon:h.value?"chevron-up":"chevron-down",class:"text-text-muted"},null,8,["icon"])]),h.value?(i(),c("div",rs,[t("div",is,[t("div",as,[t("div",ds,[(i(!0),c(O,null,I(r.value.hardware_profiles,(N,L)=>(i(),c("div",{key:L,class:"flex-shrink-0 border-r border-border relative"},[t("div",cs,[t("button",{type:"button",class:oe(["flex-1 px-4 py-3 text-sm font-medium transition-colors flex items-center min-w-0",m.value===L?"bg-background text-text-light border-b-2 border-primary":"text-text-muted hover:text-text-light hover:bg-background-soft"]),onClick:se=>m.value=L},[t("div",fs,[n(o,{icon:"microchip",class:"mr-2 flex-shrink-0"}),t("span",ms,b(L),1),t("span",ps,"("+b(te(ae(N)))+")",1)])],10,us),t("button",{type:"button",class:"ml-2 p-1 text-xs text-text-muted hover:text-text-light hover:bg-background-soft rounded flex-shrink-0 profile-actions-container",onClick:V(se=>Fe(L,se),["stop"]),title:"Profile actions"},[n(o,{icon:"cogs"})],8,vs)])]))),128)),t("button",{type:"button",class:"flex-shrink-0 px-4 py-3 text-sm font-medium text-text-muted hover:text-text-light hover:bg-background-soft transition-colors flex items-center",onClick:ce},[n(o,{icon:"plus",class:"mr-1"})])])]),m.value&&r.value.hardware_profiles[m.value]?(i(),c("div",xs,[t("div",null,[t("label",bs,[n(o,{icon:"info",class:"mr-2"}),e[31]||(e[31]=a("Description "))]),z(t("input",{type:"text",class:"form-input w-full","onUpdate:modelValue":e[7]||(e[7]=N=>r.value.hardware_profiles[m.value].description=N),placeholder:"Profile description"},null,512),[[E,r.value.hardware_profiles[m.value].description]])]),t("div",ws,[t("div",gs,[t("div",hs,[n(o,{icon:"cubes",class:"mr-2 text-primary"}),e[32]||(e[32]=t("span",{class:"text-text-muted"},"Models:",-1)),t("span",ys,b(((u=r.value.hardware_profiles[m.value].models)==null?void 0:u.length)||0),1)]),t("div",ks,[n(o,{icon:"database",class:"mr-2 text-primary"}),e[33]||(e[33]=t("span",{class:"text-text-muted"},"Total Size:",-1)),t("span",_s,b(te(ae(r.value.hardware_profiles[m.value]))),1)])])]),t("div",null,[t("div",Cs,[t("label",$s,[n(o,{icon:"cubes",class:"mr-2"}),e[34]||(e[34]=a("Models for this Profile "))]),t("button",{type:"button",class:"btn btn-sm btn-outline",onClick:e[8]||(e[8]=N=>$e(m.value))},[n(o,{icon:"plus-circle",class:"mr-1"}),e[35]||(e[35]=a("Add Models "))])]),t("div",Ms,[r.value.hardware_profiles[m.value].models&&r.value.hardware_profiles[m.value].models.length>0?(i(),c("div",Bs,[(i(!0),c(O,null,I(r.value.hardware_profiles[m.value].models,(N,L)=>(i(),c("div",{key:L,class:"flex items-center justify-between p-2 bg-background rounded border"},[t("div",Fs,[t("div",Ss,b(Ce(N)),1),t("div",Ps,[t("span",js,[n(o,{icon:"tag",class:"mr-1"}),a(b(N.type),1)]),N.tags&&N.tags.length>0?(i(),c("span",Ts,[n(o,{icon:"tags",class:"mr-1"}),a(b(N.tags.join(", ")),1)])):B("",!0),N.size?(i(),c("span",Ns,[n(o,{icon:"database",class:"mr-1"}),a(b(te(N.size)),1)])):B("",!0)])]),t("button",{type:"button",class:"ml-2 text-red-600 hover:text-red-800",onClick:se=>Be(m.value,L),title:"Remove model"},[n(o,{icon:"trash-alt"})],8,Ds)]))),128))])):(i(),c("div",Us,[n(o,{icon:"info-circle",class:"mr-1"}),e[36]||(e[36]=a("No models selected for this profile. "))]))])])])):B("",!0),Object.keys(r.value.hardware_profiles).length===0?(i(),c("div",As,[n(o,{icon:"server",class:"text-4xl text-text-muted mb-4"}),e[38]||(e[38]=t("h4",{class:"text-lg font-medium text-text-light mb-2"}," No Hardware Profiles ",-1)),e[39]||(e[39]=t("p",{class:"text-text-muted mb-4"}," Create your first hardware profile to start adding models. ",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:ce},[n(o,{icon:"plus-circle",class:"mr-1"}),e[37]||(e[37]=a("Create First Profile "))])])):B("",!0)])])):B("",!0)]}),_:1}),n(K,null,{default:R(()=>[t("div",Rs,[t("button",{type:"button",class:"btn btn-secondary",onClick:ue},[n(o,{icon:"arrow-left",class:"mr-1"}),e[40]||(e[40]=a("Back "))]),t("div",Os,[t("button",{type:"button",class:"btn btn-outline",onClick:fe},[n(o,{icon:"undo",class:"mr-1"}),e[41]||(e[41]=a("Reset Form "))]),t("button",Is,[n(o,{icon:r.value.id?"save":"plus",class:"mr-1"},null,8,["icon"]),a(" "+b(r.value.id?"Update":"Create")+" Bundle ",1)])])])]),_:1})],32)]),C.value?(i(),c("div",{key:0,class:"fixed bg-background border border-border rounded shadow-lg z-[9999] min-w-[150px] profile-actions-container",style:ve({top:A.value.top,left:A.value.left}),onClick:e[12]||(e[12]=V(()=>{},["stop"]))},[t("button",{type:"button",class:"w-full px-3 py-2 text-left text-sm text-text-light hover:bg-background-soft flex items-center",onClick:e[9]||(e[9]=u=>Se(C.value))},[n(o,{icon:"edit",class:"mr-2"}),e[42]||(e[42]=a("Rename "))]),t("button",{type:"button",class:"w-full px-3 py-2 text-left text-sm text-text-light hover:bg-background-soft flex items-center",onClick:e[10]||(e[10]=u=>Pe(C.value))},[n(o,{icon:"copy",class:"mr-2"}),e[43]||(e[43]=a("Clone "))]),t("button",{type:"button",class:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center",onClick:e[11]||(e[11]=u=>je(C.value))},[n(o,{icon:"trash-alt",class:"mr-2"}),e[44]||(e[44]=a("Delete "))])],4)):B("",!0),S.value?(i(),Y(Mt,{key:1,show:S.value,currentProfileName:s.value,groupedModels:T.value,selectedModels:d.value,popularTags:ge.value,onClose:ie,onApplySelection:Me,"onUpdate:selectedModels":e[13]||(e[13]=u=>d.value=u)},null,8,["show","currentProfileName","groupedModels","selectedModels","popularTags"])):B("",!0),$.value?(i(),c("div",zs,[t("div",Es,[t("div",Ls,[e[45]||(e[45]=t("h3",{class:"text-lg font-semibold text-text-light"},"Rename Profile",-1)),t("button",{type:"button",class:"text-text-muted hover:text-text-light",onClick:X},[n(o,{icon:"times",class:"text-xl"})])]),t("div",Ws,[t("label",Vs,[n(o,{icon:"tag",class:"mr-2"}),e[46]||(e[46]=a("Profile Name "))]),z(t("input",{ref:"renameProfileInput",type:"text",class:"form-input w-full","onUpdate:modelValue":e[14]||(e[14]=u=>P.value=u),onKeyup:[pe(de,["enter"]),pe(X,["escape"])],placeholder:"Enter new profile name"},null,544),[[E,P.value]])]),t("div",Ks,[t("button",{type:"button",class:"btn btn-secondary",onClick:X}," Cancel "),t("button",{type:"button",class:"btn btn-primary",onClick:de,disabled:!P.value.trim()},[n(o,{icon:"save",class:"mr-1"}),e[47]||(e[47]=a("Rename "))],8,Gs)])])])):B("",!0)],64)}}},Hs=ne(qs,[["__scopeId","data-v-993eca4a"]]),Ys={class:"text-text-muted mb-4 flex items-center"},Zs={key:0,class:"overflow-x-auto"},Xs={class:"min-w-full divide-y divide-border"},Js={class:"bg-background-mute"},Qs={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},eo={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},to={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},so={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},oo={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},lo={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},no={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},ro={class:"bg-background-soft divide-y divide-border"},io={class:"px-4 py-3 text-text-light"},ao={class:"px-4 py-3 text-text-light"},co={class:"px-4 py-3 text-text-light"},uo={class:"px-4 py-3 text-text-light"},fo={class:"px-4 py-3"},mo={class:"flex flex-wrap gap-1"},po={class:"px-4 py-3"},vo={class:"flex flex-wrap gap-1"},xo={class:"px-4 py-3"},bo={class:"flex space-x-1"},wo=["onClick"],go=["onClick"],ho=["onClick"],yo={key:1,class:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded flex items-start"},ko={class:"mt-4 flex justify-end"},_o={__name:"BundleManagerComponent",setup(U){const{success:f,error:k,confirm:p}=be(),g=xe(),{bundles:F}=We(g),y=_(!1),D=_({id:"",name:"",description:"",version:"1.0.0",author:"",website:"",workflows:[],hardware_profiles:{}}),h=()=>{D.value.id=null,y.value=!0},A=()=>{y.value=!1,f("Bundle saved successfully")},$=()=>{y.value=!1};le(async()=>{await Promise.all([g.fetchBundles()])});const P=async S=>{try{const s=g.getBundleById(S);D.value={id:s.id,name:s.name,description:s.description,version:s.version||"1.0.0",author:s.author||"",website:s.website||"",workflows:s.workflows||[],hardware_profiles:s.hardware_profiles||{}},y.value=!0}catch(s){console.error("Error loading bundle for editing:",s),k("Failed to load bundle for editing")}},C=async S=>{var s,d;try{const v=F.value.find(M=>M.id===S),x=v?v.name:S;await p(`Are you sure you want to delete bundle "${x}"?`,"Confirm Deletion")&&(await g.deleteBundle(S),f(`Bundle "${x}" deleted successfully`))}catch(v){console.error("Error deleting bundle:",v),k("Failed to delete bundle: "+(((d=(s=v.response)==null?void 0:s.data)==null?void 0:d.detail)||v.message))}},w=async(S,s,d)=>{var v,x;try{const m=await J.get(`/bundles/download/${S}`,{responseType:"blob"}),M=new Blob([m.data],{type:"application/zip"}),j=window.URL.createObjectURL(M),T=document.createElement("a");T.href=j,T.download=`bundle_${s.replace(/\s+/g,"_")}_v${d||"1.0.0"}.zip`,document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(j),f(`Bundle "${s}" downloaded successfully`)}catch(m){console.error("Error downloading bundle:",m),k("Failed to download bundle: "+(((x=(v=m.response)==null?void 0:v.data)==null?void 0:x.detail)||m.message))}};return(S,s)=>{const d=Q("FontAwesomeIcon");return i(),c(O,null,[y.value?B("",!0):(i(),Y(K,{key:0},{header:R(()=>[t("h3",null,[n(d,{icon:"box-open",class:"mr-2"}),s[0]||(s[0]=a("Model Bundles"))])]),default:R(()=>[t("p",Ys,[n(d,{icon:"info-circle",class:"mr-2"}),s[1]||(s[1]=a("Create predefined bundles of models with associated workflows. "))]),Object.keys(G(F)).length>0?(i(),c("div",Zs,[t("table",Xs,[t("thead",Js,[t("tr",null,[t("th",Qs,[n(d,{icon:"tag",class:"mr-1"}),s[2]||(s[2]=a("Name "))]),t("th",eo,[n(d,{icon:"code-branch",class:"mr-1"}),s[3]||(s[3]=a("Version "))]),t("th",to,[n(d,{icon:"user",class:"mr-1"}),s[4]||(s[4]=a("Author "))]),t("th",so,[n(d,{icon:"info",class:"mr-1"}),s[5]||(s[5]=a("Description "))]),t("th",oo,[n(d,{icon:"sitemap",class:"mr-1"}),s[6]||(s[6]=a("Workflows "))]),t("th",lo,[n(d,{icon:"server",class:"mr-1"}),s[7]||(s[7]=a("Hardware Profiles "))]),t("th",no,[n(d,{icon:"cogs",class:"mr-1"}),s[8]||(s[8]=a("Actions "))])])]),t("tbody",ro,[(i(!0),c(O,null,I(G(F),v=>(i(),c("tr",{key:v.id,class:"hover:bg-background-mute"},[t("td",io,b(v.name),1),t("td",ao,b(v.version||"1.0.0"),1),t("td",co,b(v.author||"N/A"),1),t("td",uo,b(v.description),1),t("td",fo,[t("div",mo,[(i(!0),c(O,null,I(v.workflows||[],x=>(i(),c("span",{key:x,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-blue-600 text-white"},[n(d,{icon:"file-code",class:"mr-1"}),a(b(x),1)]))),128))])]),t("td",po,[t("div",vo,[(i(!0),c(O,null,I(v.hardware_profiles||{},(x,m)=>{var M;return i(),c("span",{key:m,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-gray-600 text-white"},[n(d,{icon:"microchip",class:"mr-1"}),a(b(m)+" ("+b(((M=x.models)==null?void 0:M.length)||0)+" models) ",1)])}),128))])]),t("td",xo,[t("div",bo,[t("button",{class:"px-3 py-1 text-xs bg-btn-default text-white rounded hover:bg-btn-default-hover transition-colors",onClick:x=>P(v.id)},[n(d,{icon:"edit",class:"mr-1"}),s[9]||(s[9]=a("Edit "))],8,wo),t("button",{class:"px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 transition-colors",onClick:x=>w(v.id,v.name,v.version),title:"Download bundle as ZIP"},[n(d,{icon:"download",class:"mr-1"}),s[10]||(s[10]=a("Download "))],8,go),t("button",{class:"px-3 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 transition-colors",onClick:x=>C(v.id)},[n(d,{icon:"trash-alt",class:"mr-1"}),s[11]||(s[11]=a("Delete "))],8,ho)])])]))),128))])])])):(i(),c("div",yo,[n(d,{icon:"info-circle",class:"mr-2 mt-0.5"}),s[12]||(s[12]=t("span",null,"No bundles available. Create your first bundle below.",-1))])),t("div",ko,[t("button",{type:"button",class:"btn btn-primary",onClick:h},[n(d,{icon:"plus-circle",class:"mr-1"}),s[13]||(s[13]=a("New Bundle "))])])]),_:1})),y.value?(i(),Y(Hs,{key:1,"bundle-id":D.value.id,onSaved:A,onCancel:$},null,8,["bundle-id"])):B("",!0)],64)}}},Mo=ne(_o,[["__scopeId","data-v-f48c6979"]]);export{Mo as default};
