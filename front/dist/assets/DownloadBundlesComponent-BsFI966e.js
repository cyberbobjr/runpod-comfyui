import{_ as at,u as it,a as dt,r as _,c as rt,o as ct,b as a,d as t,e as h,f as d,g as x,h as s,i as V,F as r,j as ut,k as B,l as S,t as c,w as W,v as xt,m as mt,n as A,p as G,q as j,s as I,x as M,y as J,z as $,A as i,B as Q,C as pt,D as Y,E as ft,G as ht,H as vt}from"./index-Cu1PUPqU.js";const _t={class:"p-4 bg-background space-y-6"},gt={class:"card"},yt={class:"text-lg font-semibold text-text-light mb-4 flex items-center"},bt={class:"flex items-center space-x-4"},wt=["disabled"],kt={key:0,class:"text-text-muted flex items-center"},Bt={class:"text-text-muted mt-2 text-sm flex items-center"},Ct={class:"card"},Dt={class:"flex justify-between items-center mb-4"},Ut={class:"text-xl font-semibold text-text-light flex items-center"},jt={class:"flex items-center space-x-4"},It={class:"text-sm text-text-muted"},$t={class:"relative"},Ft={class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-light-muted"},Nt={class:"mb-6"},St={class:"text-text-muted mb-4 flex items-center"},At={class:"relative min-h-[200px]"},Pt={key:0,class:"absolute inset-0 flex items-center justify-center bg-background-soft bg-opacity-75 z-10"},Tt={key:1,class:"overflow-x-auto"},Ot={class:"min-w-full divide-y divide-border"},Vt={class:"bg-background-mute"},Mt={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},Et={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},Lt={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},zt={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},qt={class:"bg-background-soft divide-y divide-border"},Ht={class:"px-4 py-3"},Wt={class:"flex items-center"},Gt={class:"text-text-light font-medium"},Jt={key:0,class:"text-xs text-text-muted"},Qt={key:1,class:"text-xs text-text-muted"},Yt={class:"px-4 py-3 text-text-light max-w-xs"},Kt=["title"],Rt={class:"px-4 py-3"},Xt={class:"flex flex-wrap gap-1"},Zt={class:"px-4 py-3"},te={class:"px-4 py-3"},ee={class:"flex space-x-2"},se=["onClick"],le=["onClick"],ne=["onClick","disabled"],oe=["onClick","disabled"],ae={key:2,class:"text-center py-10"},ie={class:"flex flex-col items-center"},de={class:"text-text-muted mt-1"},re=["disabled"],ce={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ue={class:"bg-background rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-hidden mx-4"},xe={class:"flex justify-between items-center p-4 border-b border-border"},me={class:"text-lg font-semibold text-text-light"},pe={key:0,class:"p-6 overflow-y-auto max-h-[70vh]"},fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},he={class:"font-medium text-text-light mb-2 flex items-center"},ve={class:"space-y-2"},_e={class:"text-text-light"},ge={class:"text-text-light"},ye={class:"text-text-light"},be={key:0},we={class:"text-text-light"},ke=["href"],Be={class:"font-medium text-text-light mb-2 flex items-center"},Ce={class:"text-text-light"},De={class:"mb-6"},Ue={class:"font-medium text-text-light mb-3 flex items-center"},je={key:0,class:"flex flex-wrap gap-2"},Ie={key:1,class:"text-text-muted"},$e={class:"font-medium text-text-light mb-3 flex items-center"},Fe={key:0,class:"space-y-2"},Ne=["onClick"],Se={class:"flex items-center"},Ae={class:"font-medium text-text-light"},Pe={class:"ml-2 text-sm text-text-muted"},Te={class:"px-4 pb-4 bg-background-soft"},Oe={key:0,class:"text-text-muted mb-3 mt-2"},Ve={key:1},Me={class:"grid grid-cols-1 gap-2 max-h-60 overflow-y-auto"},Ee={class:"flex-1 min-w-0"},Le={class:"font-medium text-text-light truncate"},ze={class:"text-xs text-text-muted mt-1"},qe={class:"inline-flex items-center mr-3"},He={key:0,class:"inline-flex items-center"},We={key:2,class:"text-text-muted text-sm"},Ge={key:1,class:"text-text-muted"},Je={__name:"DownloadBundlesComponent",setup(Qe){const{success:F,error:g,confirm:E}=it(),{startInstallation:K}=dt(),y=_(""),p=_(!1),C=_([]),L=_([]),P=_(!1),m=_(null),b=_(new Set),T=async()=>{var l,e;try{const o=await $.get("/bundles/");C.value=o.data||[]}catch(o){g("Failed to load uploaded bundles: "+(((e=(l=o.response)==null?void 0:l.data)==null?void 0:e.message)||o.message))}},N=async()=>{var l,e;try{const o=await $.get("/bundles/installed/");L.value=o.data||[]}catch(o){g("Failed to load installed bundles: "+(((e=(l=o.response)==null?void 0:l.data)==null?void 0:e.message)||o.message))}},O=(l,e=null)=>L.value.some(o=>o.id===l&&(!e||o.profile===e)),R=async l=>{var e,o;p.value=!0;try{const u=new FormData;u.append("bundle_file",l),await $.post("/bundles/upload/",u,{headers:{"Content-Type":"multipart/form-data"}}),F(`Bundle "${l.name}" uploaded successfully`),await T()}catch(u){g("Failed to upload bundle: "+(((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.detail)||u.message))}finally{p.value=!1}},X=async l=>{const e=l.target.files[0];e&&(await R(e),l.target.value="")},z=()=>{document.getElementById("bundle-upload-file").click()},w=l=>{const e=Object.keys(l.hardware_profiles||{}),o=e.filter(u=>O(l.id,u));return o.length===0?{status:"not-installed",text:"Not Installed"}:o.length===e.length?{status:"fully-installed",text:"Fully Installed"}:{status:"partially-installed",text:`Partially Installed (${o.length}/${e.length})`}},Z=async l=>{var e,o;try{const u=Object.keys(l.hardware_profiles||{});if(u.length===0)throw new Error("No hardware profile available for this bundle");const v=u.filter(n=>!O(l.id,n));if(v.length===0){F(`Bundle "${l.name}" is already fully installed`);return}await K(l.id,l.name,v),setTimeout(async()=>{await N()},2e3)}catch(u){g("Failed to start installation: "+(((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.detail)||u.message))}},tt=async l=>{var e,o;try{if(await E(`Are you sure you want to uninstall bundle "${l.name}"?`,"Confirm Uninstall")){p.value=!0;const v=Object.keys(l.hardware_profiles||{});for(const n of v)O(l.id,n)&&await $.post("/bundles/uninstall",{bundle_id:l.id,profile:n});F(`Bundle "${l.name}" uninstalled successfully`),await N()}}catch(u){g("Failed to uninstall bundle: "+(((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.detail)||u.message))}finally{p.value=!1}},et=async l=>{var e,o;try{await E(`Are you sure you want to delete the uploaded bundle "${l.name}"? This will remove it from the server permanently.`,"Confirm Delete")&&(p.value=!0,await $.delete(`/bundles/${l.id}`),F(`Bundle "${l.name}" deleted successfully`),await T(),await N())}catch(u){g("Failed to delete bundle: "+(((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.detail)||u.message))}finally{p.value=!1}},st=l=>{m.value=l,P.value=!0},lt=l=>{b.value.has(l)?b.value.delete(l):b.value.add(l)},q=()=>{P.value=!1,m.value=null,b.value.clear()},nt=l=>l.dest?l.dest.split("/").pop():l.url?l.url.split("/").pop():"Unknown model",H=rt(()=>{if(!y.value)return C.value;const l=y.value.toLowerCase();return C.value.filter(e=>e.name.toLowerCase().includes(l)||e.description.toLowerCase().includes(l)||e.workflows&&e.workflows.some(o=>o.toLowerCase().includes(l)))});return ct(async()=>{await Promise.all([T(),N()])}),(l,e)=>{var o,u,v;return i(),a("div",_t,[t("div",gt,[t("h3",yt,[d(s(r),{icon:s(V),class:"mr-2"},null,8,["icon"]),e[1]||(e[1]=x(" Upload Bundle "))]),t("div",bt,[t("input",{type:"file",class:"hidden",id:"bundle-upload-file",onChange:X,accept:".json"},null,32),t("button",{class:"btn btn-primary",onClick:z,disabled:p.value},[d(s(r),{icon:s(V),class:"mr-1"},null,8,["icon"]),e[2]||(e[2]=x("Upload Bundle File "))],8,wt),p.value?(i(),a("div",kt,[d(s(r),{icon:s(ut),class:"animate-spin mr-1"},null,8,["icon"]),e[3]||(e[3]=x(" Processing... "))])):h("",!0)]),t("p",Bt,[d(s(r),{icon:s(B),class:"mr-1"},null,8,["icon"]),e[4]||(e[4]=x(" Upload a JSON bundle file to add it to your collection. You can then install or manage it below. "))])]),t("div",Ct,[t("div",Dt,[t("h2",Ut,[d(s(r),{icon:s(S),class:"mr-2"},null,8,["icon"]),e[5]||(e[5]=x(" Uploaded Bundles "))]),t("div",jt,[t("div",It,c(C.value.length)+" bundle"+c(C.value.length!==1?"s":"")+" uploaded ",1),t("div",$t,[W(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>y.value=n),type:"text",placeholder:"Search bundles",class:"form-input pl-10"},null,512),[[xt,y.value]]),t("span",Ft,[d(s(r),{icon:s(mt)},null,8,["icon"])])])])]),t("div",Nt,[t("p",St,[d(s(r),{icon:s(B),class:"mr-2"},null,8,["icon"]),e[6]||(e[6]=x(" Manage your uploaded bundles: view details, install/uninstall, or delete them. "))]),t("div",At,[p.value?(i(),a("div",Pt,e[7]||(e[7]=[t("div",{class:"flex flex-col items-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),t("span",{class:"mt-2 text-text-light"},"Processing...")],-1)]))):h("",!0),H.value.length>0?(i(),a("div",Tt,[t("table",Ot,[t("thead",Vt,[t("tr",null,[t("th",Mt,[d(s(r),{icon:s(S),class:"mr-1"},null,8,["icon"]),e[8]||(e[8]=x("Name "))]),t("th",Et,[d(s(r),{icon:s(B),class:"mr-1"},null,8,["icon"]),e[9]||(e[9]=x("Description "))]),t("th",Lt,[d(s(r),{icon:s(A),class:"mr-1"},null,8,["icon"]),e[10]||(e[10]=x("Profiles "))]),t("th",zt,[d(s(r),{icon:s(G),class:"mr-1"},null,8,["icon"]),e[11]||(e[11]=x("Status "))]),e[12]||(e[12]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"}," Actions ",-1))])]),t("tbody",qt,[(i(!0),a(j,null,I(H.value,n=>(i(),a("tr",{key:n.id,class:"hover:bg-background-mute"},[t("td",Ht,[t("div",Wt,[d(s(r),{icon:s(S),class:"mr-2 text-primary"},null,8,["icon"]),t("div",null,[t("span",Gt,c(n.name),1),n.author?(i(),a("div",Jt,"by "+c(n.author),1)):h("",!0),n.version?(i(),a("div",Qt,"v"+c(n.version),1)):h("",!0)])])]),t("td",Yt,[t("div",{class:"truncate",title:n.description},c(n.description),9,Kt)]),t("td",Rt,[t("div",Xt,[(i(!0),a(j,null,I(n.hardware_profiles||{},(f,D)=>{var U;return i(),a("span",{key:D,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-gray-600 text-white"},[d(s(r),{icon:s(A),class:"mr-1"},null,8,["icon"]),x(" "+c(D)+" ("+c(((U=f.models)==null?void 0:U.length)||0)+" models) ",1)])}),128))])]),t("td",Zt,[t("span",{class:Q(["px-2 py-1 inline-flex text-xs rounded items-center",w(n).status==="fully-installed"?"bg-green-800 text-white":w(n).status==="partially-installed"?"bg-yellow-700 text-white":"bg-gray-700 text-white"])},[d(s(r),{icon:w(n).status==="fully-installed"?s(G):w(n).status==="partially-installed"?s(pt):s(M),class:"mr-1"},null,8,["icon"]),x(" "+c(w(n).text),1)],2)]),t("td",te,[t("div",ee,[t("button",{onClick:f=>st(n),class:"btn btn-sm btn-outline",title:"View bundle details"},[d(s(r),{icon:s(B),class:"mr-1"},null,8,["icon"]),e[13]||(e[13]=x(" Details "))],8,se),w(n).status==="not-installed"?(i(),a("button",{key:0,onClick:f=>Z(n),class:"btn btn-sm btn-primary"},[d(s(r),{icon:s(Y),class:"mr-1"},null,8,["icon"]),e[14]||(e[14]=x(" Install "))],8,le)):(i(),a("button",{key:1,onClick:f=>tt(n),class:"btn btn-sm bg-yellow-600 hover:bg-yellow-700 text-white",disabled:p.value},[d(s(r),{icon:s(M),class:"mr-1"},null,8,["icon"]),e[15]||(e[15]=x(" Uninstall "))],8,ne)),t("button",{onClick:f=>et(n),class:"btn btn-sm bg-red-600 hover:bg-red-700 text-white",disabled:p.value,title:"Delete bundle permanently"},[d(s(r),{icon:s(ft),class:"mr-1"},null,8,["icon"]),e[16]||(e[16]=x(" Delete "))],8,oe)])])]))),128))])])])):(i(),a("div",ae,[t("div",ie,[d(s(r),{icon:s(S),class:"text-4xl text-gray-500 mb-4"},null,8,["icon"]),e[18]||(e[18]=t("h3",{class:"text-lg font-semibold text-text-light"},"No uploaded bundles",-1)),t("p",de,c(y.value?"No bundles match your search criteria.":"Upload your first bundle using the form above."),1),y.value?h("",!0):(i(),a("button",{key:0,class:"btn btn-primary mt-4",onClick:z,disabled:p.value},[d(s(r),{icon:s(V),class:"mr-1"},null,8,["icon"]),e[17]||(e[17]=x("Upload Bundle "))],8,re))])]))])])]),P.value?(i(),a("div",ce,[t("div",ue,[t("div",xe,[t("h3",me,"Bundle Details: "+c((o=m.value)==null?void 0:o.name),1),t("button",{type:"button",class:"text-text-muted hover:text-text-light",onClick:q},[d(s(r),{icon:s(M),class:"text-xl"},null,8,["icon"])])]),m.value?(i(),a("div",pe,[t("div",fe,[t("div",null,[t("h4",he,[d(s(r),{icon:s(B),class:"mr-2"},null,8,["icon"]),e[19]||(e[19]=x("Basic Information "))]),t("dl",ve,[t("div",null,[e[20]||(e[20]=t("dt",{class:"text-sm text-text-muted"},"Name:",-1)),t("dd",_e,c(m.value.name),1)]),t("div",null,[e[21]||(e[21]=t("dt",{class:"text-sm text-text-muted"},"Version:",-1)),t("dd",ge,c(m.value.version||"1.0.0"),1)]),t("div",null,[e[22]||(e[22]=t("dt",{class:"text-sm text-text-muted"},"Author:",-1)),t("dd",ye,c(m.value.author||"N/A"),1)]),m.value.website?(i(),a("div",be,[e[23]||(e[23]=t("dt",{class:"text-sm text-text-muted"},"Website:",-1)),t("dd",we,[t("a",{href:m.value.website,target:"_blank",class:"text-primary hover:underline"},c(m.value.website),9,ke)])])):h("",!0)])]),t("div",null,[t("h4",Be,[d(s(r),{icon:s(B),class:"mr-2"},null,8,["icon"]),e[24]||(e[24]=x("Description "))]),t("p",Ce,c(m.value.description),1)])]),t("div",De,[t("h4",Ue,[d(s(r),{icon:s(J),class:"mr-2"},null,8,["icon"]),x("Workflows ("+c(((u=m.value.workflows)==null?void 0:u.length)||0)+") ",1)]),((v=m.value.workflows)==null?void 0:v.length)>0?(i(),a("div",je,[(i(!0),a(j,null,I(m.value.workflows,n=>(i(),a("span",{key:n,class:"inline-flex items-center px-3 py-1 rounded text-sm bg-blue-600 text-white"},[d(s(r),{icon:s(J),class:"mr-1"},null,8,["icon"]),x(c(n),1)]))),128))])):(i(),a("p",Ie,"No workflows defined."))]),t("div",null,[t("h4",$e,[d(s(r),{icon:s(A),class:"mr-2"},null,8,["icon"]),x("Hardware Profiles ("+c(Object.keys(m.value.hardware_profiles||{}).length)+") ",1)]),Object.keys(m.value.hardware_profiles||{}).length>0?(i(),a("div",Fe,[(i(!0),a(j,null,I(m.value.hardware_profiles,(n,f)=>{var D,U;return i(),a("div",{key:f,class:"border border-border rounded-lg overflow-hidden"},[t("button",{onClick:k=>lt(f),class:"w-full px-4 py-3 bg-background-mute hover:bg-background-soft transition-colors duration-200 flex items-center justify-between text-left"},[t("div",Se,[d(s(r),{icon:s(A),class:"mr-2 text-primary"},null,8,["icon"]),t("span",Ae,c(f),1),t("span",Pe,"("+c(((D=n.models)==null?void 0:D.length)||0)+" models)",1)]),d(s(r),{icon:s(Y),class:Q([["transition-transform duration-200",b.value.has(f)?"rotate-180":""],"text-text-muted"])},null,8,["icon","class"])],8,Ne),W(t("div",Te,[n.description?(i(),a("p",Oe,c(n.description),1)):h("",!0),((U=n.models)==null?void 0:U.length)>0?(i(),a("div",Ve,[e[25]||(e[25]=t("h6",{class:"text-sm font-medium text-text-light mb-2"},"Models:",-1)),t("div",Me,[(i(!0),a(j,null,I(n.models,(k,ot)=>(i(),a("div",{key:ot,class:"flex items-center justify-between p-3 bg-background rounded border text-sm"},[t("div",Ee,[t("div",Le,c(nt(k)),1),t("div",ze,[t("span",qe,[d(s(r),{icon:s(vt),class:"mr-1"},null,8,["icon"]),x(c(k.type),1)]),k.tags&&k.tags.length>0?(i(),a("span",He," Tags: "+c(k.tags.join(", ")),1)):h("",!0)])])]))),128))])])):(i(),a("div",We,"No models in this profile."))],512),[[ht,b.value.has(f)]])])}),128))])):(i(),a("p",Ge,"No hardware profiles defined."))])])):h("",!0),t("div",{class:"flex justify-end space-x-3 p-4 border-t border-border bg-background-mute"},[t("button",{type:"button",class:"btn btn-secondary",onClick:q}," Close ")])])])):h("",!0)])}}},Ke=at(Je,[["__scopeId","data-v-5432bda5"]]);export{Ke as default};
