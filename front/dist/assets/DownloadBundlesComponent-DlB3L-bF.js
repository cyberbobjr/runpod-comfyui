import{_ as et,u as st,a as lt,r as b,c as nt,o as ot,b as a,d as e,e as f,f as d,g as m,h as s,i as O,F as r,j as at,k as w,l as F,t as c,w as it,v as dt,m as rt,n as S,p as W,q as U,s as j,x as V,y as G,z as N,A as i,B as ct,C as ut,D as mt,E as xt,G as pt}from"./index-CcCzNoNR.js";const ft={class:"p-4 bg-background space-y-6"},ht={class:"card"},vt={class:"text-lg font-semibold text-text-light mb-4 flex items-center"},_t={class:"flex items-center space-x-4"},yt=["disabled"],gt={key:0,class:"text-text-muted flex items-center"},bt={class:"text-text-muted mt-2 text-sm flex items-center"},wt={class:"card"},kt={class:"flex justify-between items-center mb-4"},Bt={class:"text-xl font-semibold text-text-light flex items-center"},Ct={class:"flex items-center space-x-4"},Dt={class:"text-sm text-text-muted"},Ut={class:"relative"},jt={class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-light-muted"},Nt={class:"mb-6"},It={class:"text-text-muted mb-4 flex items-center"},$t={class:"relative min-h-[200px]"},Ft={key:0,class:"absolute inset-0 flex items-center justify-center bg-background-soft bg-opacity-75 z-10"},St={key:1,class:"overflow-x-auto"},Tt={class:"min-w-full divide-y divide-border"},At={class:"bg-background-mute"},Pt={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},Ot={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},Vt={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},Mt={class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"},Et={class:"bg-background-soft divide-y divide-border"},Lt={class:"px-4 py-3"},zt={class:"flex items-center"},qt={class:"text-text-light font-medium"},Wt={key:0,class:"text-xs text-text-muted"},Gt={key:1,class:"text-xs text-text-muted"},Ht={class:"px-4 py-3 text-text-light max-w-xs"},Jt=["title"],Qt={class:"px-4 py-3"},Yt={class:"flex flex-wrap gap-1"},Kt={class:"px-4 py-3"},Rt={class:"px-4 py-3"},Xt={class:"flex space-x-2"},Zt=["onClick"],te=["onClick"],ee=["onClick","disabled"],se=["onClick","disabled"],le={key:2,class:"text-center py-10"},ne={class:"flex flex-col items-center"},oe={class:"text-text-muted mt-1"},ae=["disabled"],ie={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},de={class:"bg-background rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-hidden mx-4"},re={class:"flex justify-between items-center p-4 border-b border-border"},ce={class:"text-lg font-semibold text-text-light"},ue={key:0,class:"p-6 overflow-y-auto max-h-[70vh]"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},xe={class:"font-medium text-text-light mb-2 flex items-center"},pe={class:"space-y-2"},fe={class:"text-text-light"},he={class:"text-text-light"},ve={class:"text-text-light"},_e={key:0},ye={class:"text-text-light"},ge=["href"],be={class:"font-medium text-text-light mb-2 flex items-center"},we={class:"text-text-light"},ke={class:"mb-6"},Be={class:"font-medium text-text-light mb-3 flex items-center"},Ce={key:0,class:"flex flex-wrap gap-2"},De={key:1,class:"text-text-muted"},Ue={class:"font-medium text-text-light mb-3 flex items-center"},je={key:0,class:"space-y-4"},Ne={class:"flex items-center justify-between mb-3"},Ie={class:"font-medium text-text-light flex items-center"},$e={class:"text-sm text-text-muted"},Fe={key:0,class:"text-text-muted mb-3"},Se={key:1},Te={class:"grid grid-cols-1 gap-2 max-h-40 overflow-y-auto"},Ae={class:"flex-1 min-w-0"},Pe={class:"font-medium text-text-light truncate"},Oe={class:"text-xs text-text-muted"},Ve={class:"inline-flex items-center mr-2"},Me={key:0,class:"inline-flex items-center"},Ee={key:1,class:"text-text-muted"},Le={__name:"DownloadBundlesComponent",setup(ze){const{success:I,error:_,confirm:M}=st(),{startInstallation:H}=lt(),y=b(""),p=b(!1),k=b([]),E=b([]),T=b(!1),x=b(null),A=async()=>{var l,t;try{const o=await N.get("/bundles/");k.value=o.data||[]}catch(o){_("Failed to load uploaded bundles: "+(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.message)||o.message))}},$=async()=>{var l,t;try{const o=await N.get("/bundles/installed/");E.value=o.data||[]}catch(o){_("Failed to load installed bundles: "+(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.message)||o.message))}},P=(l,t=null)=>E.value.some(o=>o.id===l&&(!t||o.profile===t)),J=async l=>{var t,o;p.value=!0;try{const u=new FormData;u.append("bundle_file",l),await N.post("/bundles/upload/",u,{headers:{"Content-Type":"multipart/form-data"}}),I(`Bundle "${l.name}" uploaded successfully`),await A()}catch(u){_("Failed to upload bundle: "+(((o=(t=u.response)==null?void 0:t.data)==null?void 0:o.detail)||u.message))}finally{p.value=!1}},Q=async l=>{const t=l.target.files[0];t&&(await J(t),l.target.value="")},L=()=>{document.getElementById("bundle-upload-file").click()},g=l=>{const t=Object.keys(l.hardware_profiles||{}),o=t.filter(u=>P(l.id,u));return o.length===0?{status:"not-installed",text:"Not Installed"}:o.length===t.length?{status:"fully-installed",text:"Fully Installed"}:{status:"partially-installed",text:`Partially Installed (${o.length}/${t.length})`}},Y=async l=>{var t,o;try{const u=Object.keys(l.hardware_profiles||{});if(u.length===0)throw new Error("No hardware profile available for this bundle");const v=u.filter(n=>!P(l.id,n));if(v.length===0){I(`Bundle "${l.name}" is already fully installed`);return}await H(l.id,l.name,v),setTimeout(async()=>{await $()},2e3)}catch(u){_("Failed to start installation: "+(((o=(t=u.response)==null?void 0:t.data)==null?void 0:o.detail)||u.message))}},K=async l=>{var t,o;try{if(await M(`Are you sure you want to uninstall bundle "${l.name}"?`,"Confirm Uninstall")){p.value=!0;const v=Object.keys(l.hardware_profiles||{});for(const n of v)P(l.id,n)&&await N.post("/bundles/uninstall",{bundle_id:l.id,profile:n});I(`Bundle "${l.name}" uninstalled successfully`),await $()}}catch(u){_("Failed to uninstall bundle: "+(((o=(t=u.response)==null?void 0:t.data)==null?void 0:o.detail)||u.message))}finally{p.value=!1}},R=async l=>{var t,o;try{await M(`Are you sure you want to delete the uploaded bundle "${l.name}"? This will remove it from the server permanently.`,"Confirm Delete")&&(p.value=!0,await N.delete(`/bundles/${l.id}`),I(`Bundle "${l.name}" deleted successfully`),await A(),await $())}catch(u){_("Failed to delete bundle: "+(((o=(t=u.response)==null?void 0:t.data)==null?void 0:o.detail)||u.message))}finally{p.value=!1}},X=l=>{x.value=l,T.value=!0},z=()=>{T.value=!1,x.value=null},Z=l=>l.dest?l.dest.split("/").pop():l.url?l.url.split("/").pop():"Unknown model",q=nt(()=>{if(!y.value)return k.value;const l=y.value.toLowerCase();return k.value.filter(t=>t.name.toLowerCase().includes(l)||t.description.toLowerCase().includes(l)||t.workflows&&t.workflows.some(o=>o.toLowerCase().includes(l)))});return ot(async()=>{await Promise.all([A(),$()])}),(l,t)=>{var o,u,v;return i(),a("div",ft,[e("div",ht,[e("h3",vt,[d(s(r),{icon:s(O),class:"mr-2"},null,8,["icon"]),t[1]||(t[1]=m(" Upload Bundle "))]),e("div",_t,[e("input",{type:"file",class:"hidden",id:"bundle-upload-file",onChange:Q,accept:".json"},null,32),e("button",{class:"btn btn-primary",onClick:L,disabled:p.value},[d(s(r),{icon:s(O),class:"mr-1"},null,8,["icon"]),t[2]||(t[2]=m("Upload Bundle File "))],8,yt),p.value?(i(),a("div",gt,[d(s(r),{icon:s(at),class:"animate-spin mr-1"},null,8,["icon"]),t[3]||(t[3]=m(" Processing... "))])):f("",!0)]),e("p",bt,[d(s(r),{icon:s(w),class:"mr-1"},null,8,["icon"]),t[4]||(t[4]=m(" Upload a JSON bundle file to add it to your collection. You can then install or manage it below. "))])]),e("div",wt,[e("div",kt,[e("h2",Bt,[d(s(r),{icon:s(F),class:"mr-2"},null,8,["icon"]),t[5]||(t[5]=m(" Uploaded Bundles "))]),e("div",Ct,[e("div",Dt,c(k.value.length)+" bundle"+c(k.value.length!==1?"s":"")+" uploaded ",1),e("div",Ut,[it(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>y.value=n),type:"text",placeholder:"Search bundles",class:"form-input pl-10"},null,512),[[dt,y.value]]),e("span",jt,[d(s(r),{icon:s(rt)},null,8,["icon"])])])])]),e("div",Nt,[e("p",It,[d(s(r),{icon:s(w),class:"mr-2"},null,8,["icon"]),t[6]||(t[6]=m(" Manage your uploaded bundles: view details, install/uninstall, or delete them. "))]),e("div",$t,[p.value?(i(),a("div",Ft,t[7]||(t[7]=[e("div",{class:"flex flex-col items-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),e("span",{class:"mt-2 text-text-light"},"Processing...")],-1)]))):f("",!0),q.value.length>0?(i(),a("div",St,[e("table",Tt,[e("thead",At,[e("tr",null,[e("th",Pt,[d(s(r),{icon:s(F),class:"mr-1"},null,8,["icon"]),t[8]||(t[8]=m("Name "))]),e("th",Ot,[d(s(r),{icon:s(w),class:"mr-1"},null,8,["icon"]),t[9]||(t[9]=m("Description "))]),e("th",Vt,[d(s(r),{icon:s(S),class:"mr-1"},null,8,["icon"]),t[10]||(t[10]=m("Profiles "))]),e("th",Mt,[d(s(r),{icon:s(W),class:"mr-1"},null,8,["icon"]),t[11]||(t[11]=m("Status "))]),t[12]||(t[12]=e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-light uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",Et,[(i(!0),a(U,null,j(q.value,n=>(i(),a("tr",{key:n.id,class:"hover:bg-background-mute"},[e("td",Lt,[e("div",zt,[d(s(r),{icon:s(F),class:"mr-2 text-primary"},null,8,["icon"]),e("div",null,[e("span",qt,c(n.name),1),n.author?(i(),a("div",Wt,"by "+c(n.author),1)):f("",!0),n.version?(i(),a("div",Gt,"v"+c(n.version),1)):f("",!0)])])]),e("td",Ht,[e("div",{class:"truncate",title:n.description},c(n.description),9,Jt)]),e("td",Qt,[e("div",Yt,[(i(!0),a(U,null,j(n.hardware_profiles||{},(h,B)=>{var C;return i(),a("span",{key:B,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-gray-600 text-white"},[d(s(r),{icon:s(S),class:"mr-1"},null,8,["icon"]),m(" "+c(B)+" ("+c(((C=h.models)==null?void 0:C.length)||0)+" models) ",1)])}),128))])]),e("td",Kt,[e("span",{class:ct(["px-2 py-1 inline-flex text-xs rounded items-center",g(n).status==="fully-installed"?"bg-green-800 text-white":g(n).status==="partially-installed"?"bg-yellow-700 text-white":"bg-gray-700 text-white"])},[d(s(r),{icon:g(n).status==="fully-installed"?s(W):g(n).status==="partially-installed"?s(ut):s(V),class:"mr-1"},null,8,["icon"]),m(" "+c(g(n).text),1)],2)]),e("td",Rt,[e("div",Xt,[e("button",{onClick:h=>X(n),class:"btn btn-sm btn-outline",title:"View bundle details"},[d(s(r),{icon:s(w),class:"mr-1"},null,8,["icon"]),t[13]||(t[13]=m(" Details "))],8,Zt),g(n).status==="not-installed"?(i(),a("button",{key:0,onClick:h=>Y(n),class:"btn btn-sm btn-primary"},[d(s(r),{icon:s(mt),class:"mr-1"},null,8,["icon"]),t[14]||(t[14]=m(" Install "))],8,te)):(i(),a("button",{key:1,onClick:h=>K(n),class:"btn btn-sm bg-yellow-600 hover:bg-yellow-700 text-white",disabled:p.value},[d(s(r),{icon:s(V),class:"mr-1"},null,8,["icon"]),t[15]||(t[15]=m(" Uninstall "))],8,ee)),e("button",{onClick:h=>R(n),class:"btn btn-sm bg-red-600 hover:bg-red-700 text-white",disabled:p.value,title:"Delete bundle permanently"},[d(s(r),{icon:s(xt),class:"mr-1"},null,8,["icon"]),t[16]||(t[16]=m(" Delete "))],8,se)])])]))),128))])])])):(i(),a("div",le,[e("div",ne,[d(s(r),{icon:s(F),class:"text-4xl text-gray-500 mb-4"},null,8,["icon"]),t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-text-light"},"No uploaded bundles",-1)),e("p",oe,c(y.value?"No bundles match your search criteria.":"Upload your first bundle using the form above."),1),y.value?f("",!0):(i(),a("button",{key:0,class:"btn btn-primary mt-4",onClick:L,disabled:p.value},[d(s(r),{icon:s(O),class:"mr-1"},null,8,["icon"]),t[17]||(t[17]=m("Upload Bundle "))],8,ae))])]))])])]),T.value?(i(),a("div",ie,[e("div",de,[e("div",re,[e("h3",ce,"Bundle Details: "+c((o=x.value)==null?void 0:o.name),1),e("button",{type:"button",class:"text-text-muted hover:text-text-light",onClick:z},[d(s(r),{icon:s(V),class:"text-xl"},null,8,["icon"])])]),x.value?(i(),a("div",ue,[e("div",me,[e("div",null,[e("h4",xe,[d(s(r),{icon:s(w),class:"mr-2"},null,8,["icon"]),t[19]||(t[19]=m("Basic Information "))]),e("dl",pe,[e("div",null,[t[20]||(t[20]=e("dt",{class:"text-sm text-text-muted"},"Name:",-1)),e("dd",fe,c(x.value.name),1)]),e("div",null,[t[21]||(t[21]=e("dt",{class:"text-sm text-text-muted"},"Version:",-1)),e("dd",he,c(x.value.version||"1.0.0"),1)]),e("div",null,[t[22]||(t[22]=e("dt",{class:"text-sm text-text-muted"},"Author:",-1)),e("dd",ve,c(x.value.author||"N/A"),1)]),x.value.website?(i(),a("div",_e,[t[23]||(t[23]=e("dt",{class:"text-sm text-text-muted"},"Website:",-1)),e("dd",ye,[e("a",{href:x.value.website,target:"_blank",class:"text-primary hover:underline"},c(x.value.website),9,ge)])])):f("",!0)])]),e("div",null,[e("h4",be,[d(s(r),{icon:s(w),class:"mr-2"},null,8,["icon"]),t[24]||(t[24]=m("Description "))]),e("p",we,c(x.value.description),1)])]),e("div",ke,[e("h4",Be,[d(s(r),{icon:s(G),class:"mr-2"},null,8,["icon"]),m("Workflows ("+c(((u=x.value.workflows)==null?void 0:u.length)||0)+") ",1)]),((v=x.value.workflows)==null?void 0:v.length)>0?(i(),a("div",Ce,[(i(!0),a(U,null,j(x.value.workflows,n=>(i(),a("span",{key:n,class:"inline-flex items-center px-3 py-1 rounded text-sm bg-blue-600 text-white"},[d(s(r),{icon:s(G),class:"mr-1"},null,8,["icon"]),m(c(n),1)]))),128))])):(i(),a("p",De,"No workflows defined."))]),e("div",null,[e("h4",Ue,[d(s(r),{icon:s(S),class:"mr-2"},null,8,["icon"]),m("Hardware Profiles ("+c(Object.keys(x.value.hardware_profiles||{}).length)+") ",1)]),Object.keys(x.value.hardware_profiles||{}).length>0?(i(),a("div",je,[(i(!0),a(U,null,j(x.value.hardware_profiles,(n,h)=>{var B,C;return i(),a("div",{key:h,class:"border border-border rounded-lg p-4"},[e("div",Ne,[e("h5",Ie,[d(s(r),{icon:s(S),class:"mr-2"},null,8,["icon"]),m(c(h),1)]),e("span",$e,c(((B=n.models)==null?void 0:B.length)||0)+" models",1)]),n.description?(i(),a("p",Fe,c(n.description),1)):f("",!0),((C=n.models)==null?void 0:C.length)>0?(i(),a("div",Se,[t[25]||(t[25]=e("h6",{class:"text-sm font-medium text-text-light mb-2"},"Models:",-1)),e("div",Te,[(i(!0),a(U,null,j(n.models,(D,tt)=>(i(),a("div",{key:tt,class:"flex items-center justify-between p-2 bg-background-soft rounded border text-sm"},[e("div",Ae,[e("div",Pe,c(Z(D)),1),e("div",Oe,[e("span",Ve,[d(s(r),{icon:s(pt),class:"mr-1"},null,8,["icon"]),m(c(D.type),1)]),D.tags&&D.tags.length>0?(i(),a("span",Me," Tags: "+c(D.tags.join(", ")),1)):f("",!0)])])]))),128))])])):f("",!0)])}),128))])):(i(),a("p",Ee,"No hardware profiles defined."))])])):f("",!0),e("div",{class:"flex justify-end space-x-3 p-4 border-t border-border bg-background-mute"},[e("button",{type:"button",class:"btn btn-secondary",onClick:z}," Close ")])])])):f("",!0)])}}},We=et(Le,[["__scopeId","data-v-ea242770"]]);export{We as default};
